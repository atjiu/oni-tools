<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>缺氧小动物养殖计算器</title>
    <!-- <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> -->
    <script src="./js/consts.js"></script>
    <script src="./js/react-development-18.3.1.js"></script>
    <script src="./js/react-dom-development-18.3.1.js"></script>
    <script src="./js/babel-min-7.28.4.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%); --bg-secondary: white; --bg-tertiary: #f8f9fa; --bg-card: white; --text-primary: #2c3e50; --text-secondary: #34495e; --text-muted: #7f8c8d; --text-light: #95a5a6; --border-color: #e1e8ed; --border-light: #ecf0f1; --accent-primary: #3498db; --accent-secondary: #e74c3c; --accent-success: #27ae60; --shadow: 0 10px 30px rgba(0, 0, 0, 0.3); --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.1); }
        [data-theme="dark"] { --bg-primary: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); --bg-secondary: #1a1a1a; --bg-tertiary: #2d2d2d; --bg-card: #2d2d2d; --text-primary: #ffffff; --text-secondary: #e0e0e0; --text-muted: #b0b0b0; --text-light: #888888; --border-color: #404040; --border-light: #505050; --accent-primary: #4a9fea; --accent-secondary: #ff6b6b; --accent-success: #2ecc71; --shadow: 0 10px 30px rgba(0, 0, 0, 0.6); --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.3); }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg-primary); min-height: 100vh; padding: 20px; color: var(--text-primary); transition: all 0.3s ease; }
        .calculator-container { max-width: 1200px; margin: 0 auto; background: var(--bg-secondary); border-radius: 15px; box-shadow: var(--shadow); overflow: hidden; transition: all 0.3s ease; }
        .header { background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 30px; text-align: center; position: relative; }
        .back-button { position: absolute; top: 20px; left: 20px; background: rgba(255, 255, 255, 0.1); border: none; border-radius: 25px; padding: 10px 20px; color: white; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 1em; font-weight: 500; transition: all 0.3s ease; backdrop-filter: blur(10px); }
        .back-button:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.05); }
        @media (max-width: 768px) { .back-button { top: 10px; left: 10px; padding: 8px 15px; font-size: 0.9em; } .theme-toggle { top: 10px; right: 10px; } }
        .theme-toggle { position: absolute; top: 20px; right: 20px; background: rgba(255, 255, 255, 0.1); border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.2em; transition: all 0.3s ease; }
        .theme-toggle:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.1); }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 300; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        .content { padding: 30px; background: var(--bg-secondary); transition: all 0.3s ease; }
        .section { background: var(--bg-tertiary); border-radius: 10px; padding: 25px; margin-bottom: 25px; border-left: 4px solid var(--accent-primary); transition: all 0.3s ease; }
        .section-title { font-size: 1.4em; color: var(--text-primary); margin-bottom: 20px; font-weight: 600; display: flex; align-items: center; gap: 10px; transition: all 0.3s ease; }
        .section-title::before { content: "▶"; color: var(--accent-primary); font-size: 0.8em; }
        .input-group { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; }
        .input-group label { font-weight: 500; color: var(--text-secondary); min-width: 120px; transition: all 0.3s ease; }
        input[type="number"] { padding: 10px 15px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1em; transition: all 0.3s ease; width: 120px; background: var(--bg-card); color: var(--text-primary); }
        input[type="number"]:focus { outline: none; border-color: var(--accent-primary); box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1); }
        .checkbox-group { display: flex; gap: 25px; flex-wrap: wrap; }
        .checkbox-item { display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: var(--bg-card); border-radius: 8px; border: 2px solid var(--border-color); transition: all 0.3s ease; flex-shrink: 0; min-width: fit-content; }
        .checkbox-item:hover { border-color: var(--accent-primary); transform: translateY(-2px); }
        .checkbox-item input[type="checkbox"] { width: 18px; height: 18px; cursor: pointer; }
        .checkbox-item label { cursor: pointer; }
        .radio-group { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px; }
        .radio-item { display: flex; align-items: center; gap: 8px; padding: 8px 15px; background: var(--bg-card); border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-weight: 500; }
        .radio-item:hover { border-color: var(--accent-primary); transform: translateY(-2px); }
        .radio-item:has(input:checked) { background: rgba(52, 152, 219, 0.1); border-color: var(--accent-primary); }
        .radio-item input[type="radio"] { display: none; }
        .radio-icon { width: 32px; height: 32px; object-fit: contain; border-radius: 4px; flex-shrink: 0; }
        .results-section { background: var(--bg-card); border-radius: 12px; padding: 30px; margin-top: 25px; border: 2px solid var(--border-color); transition: all 0.3s ease; }
        .results-title { font-size: 1.4em; color: var(--accent-success); margin-bottom: 25px; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .results-grid { display: flex; flex-direction: column; gap: 20px; }
        .result-card { background: linear-gradient(135deg, var(--bg-tertiary) 0%, var(--bg-card) 100%); border-radius: 12px; padding: 25px; border-left: 5px solid var(--accent-primary); transition: all 0.3s ease; }
        .result-card:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid var(--border-light); }
        .card-title { font-size: 1.2em; font-weight: 600; color: var(--text-primary); }
        .card-stats { display: flex; gap: 15px; font-size: 0.9em; }
        .stat-ingredient, .stat-output { padding: 6px 12px; border-radius: 20px; font-weight: 500; }
        .stat-ingredient { background: rgba(52, 152, 219, 0.1); color: var(--accent-primary); }
        .stat-output { background: rgba(39, 174, 96, 0.1); color: var(--accent-success); }
        .card-content { display: flex; flex-direction: column; gap: 25px; }
        .requirements-section, .outputs-section { flex: 1; }
        .section-title { font-size: 1.1em; font-weight: 600; color: var(--text-primary); margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        .requirements-list, .outputs-list { display: flex; flex-direction: column; gap: 15px; }
        .requirement-item { background: var(--bg-card); border-radius: 8px; padding: 15px; border: 1px solid var(--border-light); transition: all 0.3s ease; }
        .requirement-item:hover { border-color: var(--accent-primary); transform: translateX(5px); }
        .requirement-main { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
        .requirement-icon { width: 40px; height: 40px; flex-shrink: 0; }
        .requirement-icon img { width: 100%; height: 100%; object-fit: contain; border-radius: 6px; border: 2px solid var(--border-color); }
        .requirement-info { flex: 1; }
        .requirement-name { font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
        .requirement-amount { color: var(--accent-primary); font-weight: 500; }
        .requirement-source { margin-top: 8px; padding-top: 8px; border-top: 1px dashed var(--border-light); }
        .source-label { font-size: 0.85em; color: var(--text-muted); margin-right: 8px; }
        .source-path { display: inline; font-size: 0.85em; color: var(--text-light); }
        .path-step { display: inline-flex; align-items: center; gap: 4px; margin: 0 2px; }
        .path-step img { width: 16px; height: 16px; object-fit: contain; border-radius: 2px; }
        .resource-requirements { margin-top: 8px; padding-top: 8px; border-top: 1px dashed var(--border-light); }
        .resource-label { font-size: 0.85em; color: var(--accent-secondary); margin-bottom: 4px; font-weight: 500; }
        .resource-list { display: flex; flex-wrap: wrap; gap: 8px; }
        .resource-item { font-size: 0.8em; color: var(--text-muted); padding: 4px 8px; background: var(--bg-tertiary); border-radius: 4px; }
        .output-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border-light); transition: all 0.3s ease; }
        .output-item:hover { border-color: var(--accent-success); transform: translateX(5px); }
        .output-icon { width: 35px; height: 35px; flex-shrink: 0; }
        .output-icon img { width: 100%; height: 100%; object-fit: contain; border-radius: 6px; border: 2px solid var(--border-color); }
        .output-info { flex: 1; }
        .output-name { font-weight: 600; color: var(--text-primary); margin-bottom: 2px; }
        .output-amount { color: var(--accent-success); font-weight: 500; font-size: 0.95em; }
        .no-outputs { text-align: center; color: var(--text-muted); font-style: italic; padding: 20px; background: var(--bg-tertiary); border-radius: 8px; border: 1px dashed var(--border-color); }
        .no-results { text-align: center; color: var(--text-muted); font-style: italic; padding: 50px 30px; background: var(--bg-tertiary); border-radius: 12px; border: 2px dashed var(--border-color); font-size: 1.1em; }
        @media (max-width: 768px) { .results-section { padding: 20px; } .result-card { padding: 20px; } .card-header { flex-direction: column; align-items: flex-start; gap: 10px; } .card-stats { width: 100%; justify-content: space-between; } .resource-list { flex-direction: column; gap: 4px; } }
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const 食物 = {
    "米虱": {"能量": 600},
    "肉": {"能量": 1600},
    "蘑菇": {"能量": 2400},
    "毛刺浆果": {"能量": 1600},
    "海生菜": {"能量": 400},
    "帕库鱼片": {"能量": 1000},
    "生蟹肉": {"能量": 1000},
    "植物肉": {"能量": 1200},
    "沼浆果冻": {"能量": 1840},
    "虫果": {"能量": 250},
    "羽叶果薯": {"能量": 4000},
    "刺壳果": {"能量": 800},
    "贫瘠虫果": {"能量": 800},
    "颚鱼片": {"能量": 1000},
    "汗甜玉米": {"能量": 800},
    "漫花果": {"能量": 325},

    // 1 千克生蛋的热量为 1600 千卡
    "生蛋": {"能量": 1600},

    "软泥膏": {"能量": 800},
    "米虱糕": {"能量": 1700},
    "豆腐": {"能量": 3600},
    "浆果糕": {"能量": 4000},
    "干肉饼": {"能量": 2600},

    "腌制米虱": {"能量": 1800},
    "煎泥膏": {"能量": 1050},
    "炙烤刺果": {"能量": 2000},
    "煎蘑菇": {"能量": 2800},
    "冰霜面包": {"能量": 1200},
    "煎蛋卷": {"能量": 2800},
    "烤肉串": {"能量": 4000},
    "烤海鲜": {"能量": 1600},
    "蛋奶酥煎饼": {"能量": 3600},
    "沼泽欢愉": {"能量": 2240},
    "烤虫果仁": {"能量": 1200},
    "虫果果酱": {"能量": 2400},
    "刺壳果烤串": {"能量": 1200},

    "浆果酿": {"能量": 4400},
    "蘑菇卷": {"能量": 4800},
    "海陆双拼": {"能量": 6000},
    "火椒面包": {"能量": 4000},
    "麻婆豆腐": {"能量": 4000},
    "蘑菇乳蛋饼": {"能量": 6400},
    "冰霜汉堡": {"能量": 6000},
    "咖喱豆": {"能量": 5000},
    "混合浆果派": {"能量": 4200},

    "果薯条": {"能量": 5400},
    "炸豆小吃": {"能量": 5000},
    "鱼肉卷": {"能量": 4200},
    "蟹肉天妇罗": {"能量": 4200},

    "嫩肋排": {"能量": 16000},
    "熏鱼": {"能量": 4200},
    "爆米花": {"能量": 2862.5},
};
const 植物 = {
    "米虱木": {"生长周期": [3,12], "人工培育": {"施肥": {"泥土":[10,0]}}, "米虱": 1},
    "毛刺花": {"生长周期": [6,24], "人工培育": {"灌溉": {"水":[20,0]}}, "毛刺浆果": 1},
    "夜幕菇": {"生长周期": [7.5,30], "人工培育": {"施肥": {"菌泥":[4,0]}}, "蘑菇": 1},
    "冰霜小麦": {"生长周期": [18,72], "人工培育": {"灌溉": {"水":[20,0]}, "施肥": {"泥土":[5,0]}}, "冰霜麦粒": 18},
    "小吃芽": {"生长周期": [21,84], "人工培育": {"灌溉": {"乙醇":[20,0]}, "施肥": {"泥土":[5,0]}}, "小吃豆": 12},
    "水草": {"生长周期": [12,48], "人工培育": {"灌溉": {"盐水":[5,0]}, "施肥": {"漂白石":[0.5,0]}}, "海生菜": 12},
    "火椒藤": {"生长周期": [8,32], "人工培育": {"灌溉": {"污染水":[35,0]}, "施肥": {"磷矿":[1,0]}}, "火椒粒": 4},
    "沼浆笼": {"生长周期": [6.6,26.4], "人工培育": {"灌溉": {"污染水":[40,0]}}, "沼浆果冻": 1},
    "贫瘠虫果芽": {"生长周期": [4,16], "人工培育": {"施肥": {"硫":[10,0]}}, "贫瘠虫果": 1},
    "虫果芽": {"生长周期": [8,32], "人工培育": {"施肥": {"硫":[10,0]}}, "虫果": 8},
    "土星动物捕草": {"生长周期": [30,120], "人工培育": {"灌溉": {"污染水":[10,0]}}, "植物肉": 10},
    "刺壳果灌木": {"生长周期": [3,12], "人工培育": {"施肥": {"磷矿":[5,0]}}, "刺壳果": 1},
    "羽叶果薯植株": {"生长周期": [9,36], "人工培育": {"灌溉": {"乙醇":[15,0]}}, "羽叶果薯": 1},
    "汗甜玉米杆": {"生长周期": [3,12], "人工培育": {"施肥": {"泥炭":[10,0]}}, "汗甜玉米": 1},
    "巨蕨": {"生长周期": [9,36], "人工培育": {"灌溉": {"氯气":[54,13.5]}}, "巨蕨谷粒": 36},
    "乔木树": {"生长周期": [0.9,3.6] /*乔木5个树枝独立生长*/, "人工培育": {"灌溉": {"污染水":[70,0]}, "施肥": {"泥土":[10,0]}}, "木材": 300},
    "露珠藤": {"生长周期": [2,8], "人工培育": {"施肥": {"浓盐冰":[10,0]}}, "露珠": 1},
    "芳香百合": {"生长周期": [12,48], "人工培育": {}, "芳香百合花": 2},
    "糖心树": {"生长周期": [4.5,18], "人工培育": {"施肥": {"雪":[100,0]}}, "花蜜": 20},
    "释气草": {"生长周期": [4,16], "人工培育": {"灌溉": {"液态氯":[0.5,0]}, "施肥": {"泥土":[25,0]}}, "释气草": 1},
    "漫殖藤": {"生长周期": [3,12], "人工培育": {"灌溉": {"水":[90,0]}}, "漫花果": 24},
};
const 动物 = {
    "绒犸兔": {"分类": "寒霜行星包", "食物": [["羽叶果薯植株", "44.44%", "绒犸兔碎糜", "30kg"],["羽叶果薯", "0.4444kg", "绒犸兔碎糜", "30kg"],["果薯条", "0.25kg", "绒犸兔碎糜", "30kg"],["小吃芽", "14.17%", "绒犸兔碎糜", "30kg"],["小吃豆", "1.6kg", "绒犸兔碎糜", "30kg"]]},
    "皇犸兔": {"分类": "寒霜行星包", "食物": [["羽叶果薯植株", "44.44%", "绒犸兔碎糜", "30kg"],["羽叶果薯", "0.4444kg", "绒犸兔碎糜", "30kg"],["果薯条", "0.25kg", "绒犸兔碎糜", "30kg"],["小吃芽", "14.17%", "绒犸兔碎糜", "30kg"],["小吃豆", "1.6kg", "绒犸兔碎糜", "30kg"]]},
    "逸蜥": {"分类": "史前行星包", "食物": [["露珠", "1kg", "漂白石", "10kg"]]},
    "狐鹿": {"分类": "寒霜行星包", "食物": [["刺壳果灌木","20%","泥土","5kg"],["刺壳果","0.2kg","泥土","5kg"],["毛刺花","10%","泥土","5kg"],["毛刺浆果","0.1kg","泥土","5kg"]]},
    "甜素甲虫": {"分类": "眼冒金星", "食物": [["硫","20kg","蔗糖","10kg"]]},
    "毛鳞壁虎": {"分类": "本体壁虎", "食物": [["火椒藤","9.375%","磷矿","10kg"],["芳香百合","6.25%","磷矿","10kg"],["米虱木","25%","磷矿","10kg"]]},
    "虫果果虫": {"分类": "眼冒金星", "食物": [["硫","50kg","泥巴","5kg"],["蔗糖","30kg","泥巴","30kg"]]},
    "滑鳞壁虎": {"分类": "本体壁虎", "食物": [["米虱木","33.33%","磷矿","9kg"],["毛刺花","16.67%","磷矿","9kg"]]},
    "好吃哈奇": {"分类": "本体哈奇", "食物": [["沙子","140kg","煤炭","70kg"],["砂岩","140kg","煤炭","70kg"],["粘土","140kg","煤炭","70kg"],["碎岩","140kg","煤炭","70kg"],["泥土","140kg","煤炭","70kg"],["沉积岩","140kg","煤炭","70kg"],["页岩","140kg","煤炭","70kg"],["营养棒","0.875kg","煤炭","0.6562kg"],["软泥膏","0.875kg","煤炭","0.6562kg"],["米虱","1.2kg","煤炭","0.875kg"],["漫花果","2.2kg","煤炭","1.6kg"],["淤泥根","0.875kg","煤炭","0.6562kg"],["六角根果实","0.1094kg","煤炭","0.082kg"],["沼泽甜菜心","0.2917kg","煤炭","0.2187kg"],["雪莓","0.875kg","煤炭","0.6562kg"],["蘑菇","0.2917kg","煤炭","0.2187kg"],["海生菜","1.7kg","煤炭","1.3kg"],["生蛋","0.4375kg","煤炭","0.3281kg"],["肉","0.4375kg","煤炭","0.3281kg"],["植物肉","0.5833kg","煤炭","0.4375kg"],["毛刺浆果","0.4375kg","煤炭","0.3281kg"],["沼浆果冻","0.3804kg","煤炭","0.2853kg"],["帕库鱼片","0.7kg","煤炭","0.525kg"],["生蟹肉","0.7kg","煤炭","0.525kg"],["颚鱼片","0.7kg","煤炭","0.525kg"],["贫瘠虫果","0.875kg","煤炭","0.6562kg"],["虫果","2.8kg","煤炭","2.1kg"],["刺壳果","0.875kg","煤炭","0.6562kg"],["羽叶果薯","0.175kg","煤炭","0.1312kg"],["干肉饼","0.2692kg","煤炭","0.2019kg"],["果薯条","0.1296kg","煤炭","0.0972kg"],["烘烤拟种","0.4667kg","煤炭","0.35kg"],["炸肉块","0.175kg","煤炭","0.1312kg"],["炸豆小吃","0.14kg","煤炭","0.105kg"],["鱼肉卷","0.1667kg","煤炭","0.125kg"],["蟹肉天妇罗","0.1667kg","煤炭","0.125kg"],["汗甜玉米","0.875kg","煤炭","0.6562kg"],["菌斑果","0.875kg","煤炭","0.6562kg"],["腌制米虱","0.3889kg","煤炭","0.2917kg"],["米虱糕","0.4118kg","煤炭","0.3088kg"],["煎泥膏","0.6667kg","煤炭","0.5kg"],["炙烤刺果","0.35kg","煤炭","0.2625kg"],["沼泽欢愉","0.3125kg","煤炭","0.2344kg"],["煎蘑菇","0.25kg","煤炭","0.1875kg"],["刺壳果烤串","0.5833kg","煤炭","0.4375kg"],["冰霜面包","0.5833kg","煤炭","0.4375kg"],["煎蛋卷","0.25kg","煤炭","0.1875kg"],["烤海鲜","0.4375kg","煤炭","0.3281kg"],["爆米花","0.2445kg","煤炭","0.1834kg"],["蛋奶酥煎饼","0.1944kg","煤炭","0.1458kg"],["熏鱼","0.25kg","煤炭","0.1875kg"],["烤肉串","0.175kg","煤炭","0.1312kg"],["嫩肋排","0.14kg","煤炭","0.105kg"],["烤虫果仁","0.5833kg","煤炭","0.4375kg"],["虫果果酱","0.2917kg","煤炭","0.2187kg"],["浆果糕","0.175kg","煤炭","0.1312kg"],["浆果酿","0.1591kg","煤炭","0.1193kg"],["海陆双拼","0.1167kg","煤炭","0.0875kg"],["蘑菇卷","0.1458kg","煤炭","0.1094kg"],["豆腐","0.1944kg","煤炭","0.1458kg"],["咖喱豆","0.14kg","煤炭","0.105kg"],["火椒面包","0.175kg","煤炭","0.1312kg"],["麻婆豆腐","0.175kg","煤炭","0.1312kg"],["蘑菇乳蛋饼","0.1094kg","煤炭","0.082kg"],["混合浆果派","0.1667kg","煤炭","0.125kg"],["冰霜汉堡","0.1167kg","煤炭","0.0875kg"]]},
    "石壳哈奇": {"分类": "本体哈奇", "食物": [["沉积岩","140kg","煤炭","70kg"],["火成岩","140kg","煤炭","70kg"],["黑曜石","140kg","煤炭","70kg"],["花岗岩","140kg","煤炭","70kg"],["铜矿","140kg","煤炭","35kg"],["钴矿","140kg","煤炭","35kg"],["铝矿","140kg","煤炭","35kg"],["镍矿","140kg","煤炭","35kg"],["朱砂矿","140kg","煤炭","35kg"],["铁矿","140kg","煤炭","35kg"],["金汞齐","140kg","煤炭","35kg"],["黑钨矿","140kg","煤炭","35kg"]]},
    "光滑哈奇": {"分类": "本体哈奇", "食物": [["铜矿","100kg","铜","75kg"],["钴矿","100kg","钴","75kg"],["铝矿","100kg","铝","75kg"],["镍矿","100kg","镍","75kg"],["朱砂矿","100kg","固态汞","75kg"],["铁矿","100kg","铁","75kg"],["金汞齐","100kg","金","75kg"],["黑钨矿","100kg","钨","75kg"]]},
    "草质哈奇": {"分类": "本体哈奇", "食物": [["泥土","140kg","煤炭","140kg"],["菌泥","140kg","煤炭","140kg"],["藻类","140kg","煤炭","140kg"],["肥料","140kg","煤炭","140kg"],["污染土","140kg","煤炭","140kg"],["营养棒","0.875kg","煤炭","0.875kg"],["软泥膏","0.875kg","煤炭","0.875kg"],["米虱","1.2kg","煤炭","1.2kg"],["漫花果","2.2kg","煤炭","2.2kg"],["淤泥根","0.875kg","煤炭","0.875kg"],["六角根果实","0.1094kg","煤炭","0.1094kg"],["沼泽甜菜心","0.2917kg","煤炭","0.2917kg"],["雪莓","0.875kg","煤炭","0.875kg"],["蘑菇","0.2917kg","煤炭","0.2917kg"],["海生菜","1.7kg","煤炭","1.7kg"],["生蛋","0.4375kg","煤炭","0.4375kg"],["肉","0.4375kg","煤炭","0.4375kg"],["植物肉","0.5833kg","煤炭","0.5833kg"],["毛刺浆果","0.4375kg","煤炭","0.4375kg"],["沼浆果冻","0.3804kg","煤炭","0.3804kg"],["帕库鱼片","0.7kg","煤炭","0.7kg"],["生蟹肉","0.7kg","煤炭","0.7kg"],["颚鱼片","0.7kg","煤炭","0.7kg"],["贫瘠虫果","0.875kg","煤炭","0.875kg"],["虫果","2.8kg","煤炭","2.8kg"],["刺壳果","0.875kg","煤炭","0.875kg"],["羽叶果薯","0.175kg","煤炭","0.175kg"],["干肉饼","0.2692kg","煤炭","0.2692kg"],["果薯条","0.1296kg","煤炭","0.1296kg"],["烘烤拟种","0.4667kg","煤炭","0.4667kg"],["炸肉块","0.175kg","煤炭","0.175kg"],["炸豆小吃","0.14kg","煤炭","0.14kg"],["鱼肉卷","0.1667kg","煤炭","0.1667kg"],["蟹肉天妇罗","0.1667kg","煤炭","0.1667kg"],["汗甜玉米","0.875kg","煤炭","0.875kg"],["菌斑果","0.875kg","煤炭","0.875kg"],["腌制米虱","0.3889kg","煤炭","0.3889kg"],["米虱糕","0.4118kg","煤炭","0.4118kg"],["煎泥膏","0.6667kg","煤炭","0.6667kg"],["炙烤刺果","0.35kg","煤炭","0.35kg"],["沼泽欢愉","0.3125kg","煤炭","0.3125kg"],["煎蘑菇","0.25kg","煤炭","0.25kg"],["刺壳果烤串","0.5833kg","煤炭","0.5833kg"],["冰霜面包","0.5833kg","煤炭","0.5833kg"],["煎蛋卷","0.25kg","煤炭","0.25kg"],["烤海鲜","0.4375kg","煤炭","0.4375kg"],["爆米花","0.2445kg","煤炭","0.2445kg"],["蛋奶酥煎饼","0.1944kg","煤炭","0.1944kg"],["熏鱼","0.25kg","煤炭","0.25kg"],["烤肉串","0.175kg","煤炭","0.175kg"],["嫩肋排","0.14kg","煤炭","0.14kg"],["烤虫果仁","0.5833kg","煤炭","0.5833kg"],["虫果果酱","0.2917kg","煤炭","0.2917kg"],["浆果糕","0.175kg","煤炭","0.175kg"],["浆果酿","0.1591kg","煤炭","0.1591kg"],["海陆双拼","0.1167kg","煤炭","0.1167kg"],["蘑菇卷","0.1458kg","煤炭","0.1458kg"],["豆腐","0.1944kg","煤炭","0.1944kg"],["咖喱豆","0.14kg","煤炭","0.14kg"],["火椒面包","0.175kg","煤炭","0.175kg"],["麻婆豆腐","0.175kg","煤炭","0.175kg"],["蘑菇乳蛋饼","0.1094kg","煤炭","0.1094kg"],["混合浆果派","0.1667kg","煤炭","0.1667kg"],["冰霜汉堡","0.1167kg","煤炭","0.1167kg"]]},
    "锹环田鼠": {"分类": "本体田鼠", "食物": [["浮土","4.8t","浮土","2.4t"],["泥土","4.8t","泥土","2.4t"],["铁矿","4.8t","铁矿","2.4t"]]},
    "珍馐田鼠": {"分类": "本体田鼠", "食物": [["浮土","4.8t","浮土","2.4t"],["泥土","4.8t","泥土","2.4t"],["铁矿","4.8t","铁矿","2.4t"]]},
    "浮油生物": {"分类": "本体浮油生物", "食物": [["二氧化碳","20kg","原油","10kg"]]},
    "长毛浮油生物": {"分类": "本体浮油生物", "食物": [["氧气", "30kg"]]},
    "熔岩浮油生物": {"分类": "本体浮油生物", "食物": [["二氧化碳","20kg","石油","10kg"]]},
    "帕库鱼": {"分类": "本体帕库鱼", "食物": [["藻类","7.5kg","污染土","3.8kg"],["海梳蕨叶","20kg","污染土","10kg"],["海梳蕨","40%","污染土","10kg"],["羽叶果薯种子","1kg","污染土","0.5kg"],["拟种","1kg","污染土","0.5kg"],["气囊芦荟种子","1kg","污染土","0.5kg"],["小吃豆","1kg","污染土","0.5kg"],["顶针芦苇种子","1kg","污染土","0.5kg"],["米虱木种子","1kg","污染土","0.5kg"],["冰霜麦粒","1kg","污染土","0.5kg"],["汗甜玉米种子","1kg","污染土","0.5kg"],["露珠藤种子","1kg","污染土","0.5kg"],["露饵花种子","1kg","污染土","0.5kg"],["释气草种子","1kg","污染土","0.5kg"],["火椒种子","1kg","污染土","0.5kg"],["糖心树种子","1kg","污染土","0.5kg"],["水草种子","1kg","污染土","0.5kg"],["沙盐藤种子","1kg","污染土","0.5kg"],["毛刺花种子","1kg","污染土","0.5kg"],["夜幕菇孢子","1kg","污染土","0.5kg"],["沼浆笼种子","1kg","污染土","0.5kg"],["芳香百合种子","1kg","污染土","0.5kg"],["虫果种子","1kg","污染土","0.5kg"],["刺壳果灌木种子","1kg","污染土","0.5kg"]]},
    "大嘴鱼": {"分类": "本体帕库鱼", "食物": [["藻类","7.5kg","污染土","3.8kg"],["海梳蕨叶","20kg","污染土","10kg"],["海梳蕨","40%","污染土","10kg"],["羽叶果薯种子","1kg","污染土","0.5kg"],["拟种","1kg","污染土","0.5kg"],["气囊芦荟种子","1kg","污染土","0.5kg"],["小吃豆","1kg","污染土","0.5kg"],["顶针芦苇种子","1kg","污染土","0.5kg"],["米虱木种子","1kg","污染土","0.5kg"],["冰霜麦粒","1kg","污染土","0.5kg"],["汗甜玉米种子","1kg","污染土","0.5kg"],["露珠藤种子","1kg","污染土","0.5kg"],["露饵花种子","1kg","污染土","0.5kg"],["释气草种子","1kg","污染土","0.5kg"],["火椒种子","1kg","污染土","0.5kg"],["糖心树种子","1kg","污染土","0.5kg"],["水草种子","1kg","污染土","0.5kg"],["沙盐藤种子","1kg","污染土","0.5kg"],["毛刺花种子","1kg","污染土","0.5kg"],["夜幕菇孢子","1kg","污染土","0.5kg"],["沼浆笼种子","1kg","污染土","0.5kg"],["芳香百合种子","1kg","污染土","0.5kg"],["虫果种子","1kg","污染土","0.5kg"],["刺壳果灌木种子","1kg","污染土","0.5kg"]]},
    "热带帕库鱼": {"分类": "本体帕库鱼", "食物": [["藻类","7.5kg","污染土","3.8kg"],["海梳蕨叶","20kg","污染土","10kg"],["海梳蕨","40%","污染土","10kg"],["羽叶果薯种子","1kg","污染土","0.5kg"],["拟种","1kg","污染土","0.5kg"],["气囊芦荟种子","1kg","污染土","0.5kg"],["小吃豆","1kg","污染土","0.5kg"],["顶针芦苇种子","1kg","污染土","0.5kg"],["米虱木种子","1kg","污染土","0.5kg"],["冰霜麦粒","1kg","污染土","0.5kg"],["汗甜玉米种子","1kg","污染土","0.5kg"],["露珠藤种子","1kg","污染土","0.5kg"],["露饵花种子","1kg","污染土","0.5kg"],["释气草种子","1kg","污染土","0.5kg"],["火椒种子","1kg","污染土","0.5kg"],["糖心树种子","1kg","污染土","0.5kg"],["水草种子","1kg","污染土","0.5kg"],["沙盐藤种子","1kg","污染土","0.5kg"],["毛刺花种子","1kg","污染土","0.5kg"],["夜幕菇孢子","1kg","污染土","0.5kg"],["沼浆笼种子","1kg","污染土","0.5kg"],["芳香百合种子","1kg","污染土","0.5kg"],["虫果种子","1kg","污染土","0.5kg"],["刺壳果灌木种子","1kg","污染土","0.5kg"]]},
    "颚鱼": {"分类": "史前行星包", "食物": [["帕库鱼","200kg","铁锈","60kg"],["大嘴鱼","200kg","铁锈","60kg"],["热带帕库鱼","200kg","铁锈","60kg"],["帕库鱼片","1kg","铁锈","60kg"]]},
    "喷浮飞鱼": {"分类": "本体飞鱼", "食物": [["污染氧","50kg","菌泥","47.5kg"]]},
    "贵族飞鱼": {"分类": "本体飞鱼", "食物": [["污染氧","30kg","菌泥","3kg"],["氯气","30kg","漂白石","3kg"],["氧气","30kg","氧石","3kg"]]},
    "洁净飞鱼": {"分类": "本体飞鱼", "食物": [["氯气","30kg","漂白石","28.5kg"]]},
    "厚壳飞鱼": {"分类": "本体飞鱼", "食物": [["氧气","50kg","氧石","47.5kg"]]},
    "霸王鹦": {"分类": "史前行星包", "食物": [["硬肉","0.5kg","浓盐冰","64kg"],["肉","0.5kg","浓盐冰","64kg"],["好吃哈奇","0.5kg","浓盐冰","128kg"],["好吃哈奇幼崽","0.5kg","浓盐冰","128kg"],["草质哈奇","0.5kg","浓盐冰","128kg"],["草质哈奇幼崽","0.5kg","浓盐冰","128kg"],["光滑哈奇","0.5kg","浓盐冰","128kg"],["光滑哈奇幼崽","0.5kg","浓盐冰","128kg"],["石壳哈奇","0.5kg","浓盐冰","128kg"],["石壳哈奇幼崽","0.5kg","浓盐冰","128kg"],["树鼠","0.5kg","浓盐冰","128kg"],["树鼠幼崽","0.5kg","浓盐冰","128kg"],["毛绒树鼠","0.5kg","浓盐冰","128kg"],["毛绒树鼠幼崽","0.5kg","浓盐冰","128kg"],["锹环田鼠","0.5kg","浓盐冰","128kg"],["锹环田鼠幼崽","0.5kg","浓盐冰","128kg"],["珍馐田鼠","0.5kg","浓盐冰","128kg"],["珍馐田鼠幼崽","0.5kg","浓盐冰","128kg"],["浮油生物","0.5kg","浓盐冰","128kg"],["浮油生物幼体","0.5kg","浓盐冰","128kg"],["长毛浮油生物","0.5kg","浓盐冰","128kg"],["长毛浮油生物幼体","0.5kg","浓盐冰","128kg"],["熔岩浮油生物","0.5kg","浓盐冰","128kg"],["熔岩浮油生物幼体","0.5kg","浓盐冰","128kg"],["毛鳞壁虎","0.5kg","浓盐冰","128kg"],["毛鳞壁虎幼崽","0.5kg","浓盐冰","128kg"],["滑鳞壁虎","0.5kg","浓盐冰","128kg"],["滑鳞壁虎幼崽","0.5kg","浓盐冰","128kg"],["尖块兽幼崽","0.5kg","浓盐冰","128kg"],["逸蜥","0.5kg","浓盐冰","128kg"],["逸蜥幼崽","0.5kg","浓盐冰","128kg"],["虫果果虫","0.5kg","浓盐冰","128kg"],["虫果果虫幼虫","0.5kg","浓盐冰","128kg"],["甜素甲虫","0.5kg","浓盐冰","128kg"],["甜素甲虫幼虫","0.5kg","浓盐冰","128kg"],["电弧蛞蝓","0.5kg","浓盐冰","128kg"],["电弧蛞蝓幼体","0.5kg","浓盐冰","128kg"],["烟雾蛞蝓","0.5kg","浓盐冰","128kg"],["烟雾蛞蝓幼体","0.5kg","浓盐冰","128kg"],["海绵蛞蝓","0.5kg","浓盐冰","128kg"],["海绵蛞蝓幼体","0.5kg","浓盐冰","128kg"],["绒犸兔幼崽","0.5kg","浓盐冰","128kg"],["皇犸兔幼崽","0.5kg","浓盐冰","128kg"],["狐鹿","0.5kg","浓盐冰","128kg"],["狐鹿幼崽","0.5kg","浓盐冰","128kg"]]},
    "栓角海豹": {"分类": "寒霜行星包", "食物": [["糖心树","40kg","乙醇","40kg"],["蔗糖","30.8kg","乙醇","40kg"]]},
    "树鼠": {"分类": "本体树鼠", "食物": [["乔木树","8.889%","泥土","20kg"],["顶针芦苇","20%","泥土","20kg"],["糖心树","0.4kg","泥土","20kg"]]},
    "毛绒树鼠": {"分类": "本体树鼠", "食物": [["乔木树","11.11%","泥土","12.5kg"],["顶针芦苇","25%","泥土","12.5kg"],["糖心树","0.5kg","泥土","12.5kg"]]},
    "电弧蛞蝓": {"分类": "眼冒金星", "食物": [["铜矿","60kg","氢气","3kg"],["钴矿","60kg","氢气","3kg"],["铝矿","60kg","氢气","3kg"],["金汞齐","60kg","氢气","3kg"],["镍矿","60kg","氢气","3kg"],["铁矿","60kg","氢气","3kg"],["朱砂矿","60kg","氢气","3kg"],["镍","60kg","氢气","3kg"],["铜","60kg","氢气","3kg"],["钨","60kg","氢气","3kg"],["铅","60kg","氢气","3kg"],["固态汞","60kg","氢气","3kg"],["金","60kg","氢气","3kg"],["铱","60kg","氢气","3kg"],["钴","60kg","氢气","3kg"],["贫铀","60kg","氢气","3kg"],["铁","60kg","氢气","3kg"],["铝","60kg","氢气","3kg"]]},
    "烟雾蛞蝓": {"分类": "眼冒金星", "食物": [["铜矿","30kg","氢气","1.5kg"],["钴矿","30kg","氢气","1.5kg"],["铝矿","30kg","氢气","1.5kg"],["金汞齐","30kg","氢气","1.5kg"],["镍矿","30kg","氢气","1.5kg"],["铁矿","30kg","氢气","1.5kg"],["朱砂矿","30kg","氢气","1.5kg"],["镍","30kg","氢气","1.5kg"],["铜","30kg","氢气","1.5kg"],["钨","30kg","氢气","1.5kg"],["铅","30kg","氢气","1.5kg"],["固态汞","30kg","氢气","1.5kg"],["金","30kg","氢气","1.5kg"],["铱","30kg","氢气","1.5kg"],["钴","30kg","氢气","1.5kg"],["贫铀","30kg","氢气","1.5kg"],["铁","30kg","氢气","1.5kg"],["铝","30kg","氢气","1.5kg"]]},
    "海绵蛞蝓": {"分类": "眼冒金星", "食物": [["铜矿","30kg","氢气","1.5kg"],["钴矿","30kg","氢气","1.5kg"],["铝矿","30kg","氢气","1.5kg"],["金汞齐","30kg","氢气","1.5kg"],["镍矿","30kg","氢气","1.5kg"],["铁矿","30kg","氢气","1.5kg"],["朱砂矿","30kg","氢气","1.5kg"],["镍","30kg","氢气","1.5kg"],["铜","30kg","氢气","1.5kg"],["钨","30kg","氢气","1.5kg"],["铅","30kg","氢气","1.5kg"],["固态汞","30kg","氢气","1.5kg"],["金","30kg","氢气","1.5kg"],["铱","30kg","氢气","1.5kg"],["钴","30kg","氢气","1.5kg"],["贫铀","30kg","氢气","1.5kg"],["铁","30kg","氢气","1.5kg"],["铝","30kg","氢气","1.5kg"]]},
    "尖块兽": {"分类": "史前行星包", "食物": [["漫花果","4kg","泥炭","200kg"],["毛刺浆果","0.8125kg","泥炭","200kg"],["沼浆果冻","0.7065kg","泥炭","300kg"]]},

    "抛壳蟹": {"分类": "本体螃蟹", "食物": [["污染土","70kg","沙子","35kg"],["腐烂物","70kg","沙子","35kg"]]},
    "沙泥蟹": {"分类": "本体螃蟹", "食物": [["污染土","70kg","沙子","35kg"],["腐烂物","70kg","沙子","35kg"],["菌泥","70kg","沙子","35kg"]]},
    "木壳蟹": {"分类": "本体螃蟹", "食物": [["污染土","70kg","沙子","35kg"],["腐烂物","70kg","沙子","35kg"],["菌泥","70kg","沙子","35kg"]]},

    "释气海牛": {"分类": "外星生物", "食物": [["释气草","50%","天然气","10kg"]]},

    "发光虫": {"分类": "本体发光虫", "食物": [["毛刺浆果","0.166kg"],["炙烤刺果","0.166kg"],["刺壳果","0.166kg"],["刺壳果烤串","0.166kg"],["磷矿","0.166kg"]]},
    "深渊虫": {"分类": "本体发光虫", "食物": [["浆果酿","1kg"],["肉","1kg"],["烤肉串","1kg"],["深渊晶石","1kg"],["精炼磷","1kg"]]},
    "天蓝虫": {"分类": "本体发光虫", "食物": [["火椒面包","1kg"],["浆果酿","1kg"],["磷矿","1kg"],["精炼磷","1kg"]]},
    "光耀虫": {"分类": "本体发光虫", "食物": [["烤肉串","1kg"],["钻石","1kg"]]},
    "阳光虫": {"分类": "本体发光虫", "食物": [["蘑菇","0.25kg"],["煎蘑菇","0.25kg"],["炙烤刺果","0.25kg"],["刺壳果烤串","0.25kg"],["磷矿","0.25kg"]]},
    "珊瑚虫": {"分类": "本体发光虫", "食物": [["煎蘑菇","1kg"],["火椒面包","1kg"],["毛刺浆果","1kg"],["炙烤刺果","1kg"],["刺壳果烤串","1kg"],["浆果酿","1kg"],["磷矿","1kg"]]},
    "皇家虫": {"分类": "本体发光虫", "食物": [["煎蘑菇","1kg"],["炙烤刺果","1kg"],["刺壳果烤串","1kg"],["火椒粒","1kg"],["火椒面包","1kg"],["磷矿","1kg"]]},
};
function CritterCalculator() {
    const [critterNumber, setCritterNumber] = React.useState(5);
    const [selectedCritter, setSelectedCritter] = React.useState("");
    const [wildPlant, setWildPlant] = React.useState(false);
    const [fertilization, setFertilization] = React.useState(false);
    const [result, setResult] = React.useState([]);
    const [isDarkTheme, setIsDarkTheme] = React.useState(false);
    const [activeCategory, setActiveCategory] = React.useState("全部");

    React.useEffect(() => {
        const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
        setIsDarkTheme(mediaQuery.matches);

        const handleChange = (e) => {
            setIsDarkTheme(e.matches);
        };

        mediaQuery.addEventListener('change', handleChange);
        return () => mediaQuery.removeEventListener('change', handleChange);
    }, []);

    React.useEffect(() => {
        document.documentElement.setAttribute('data-theme', isDarkTheme ? 'dark' : 'light');
    }, [isDarkTheme]);

    const goToHome = () => {
        window.location.href = 'index.html';
    };

    const toggleTheme = () => {
        setIsDarkTheme(!isDarkTheme);
    };

    const findFoodSources = (foodName, amountNeeded, path = []) => {
        let sources = [];
        if (path.includes(foodName)) return sources;
        let newPath = [...path, foodName];

        const isPercentage = typeof amountNeeded === 'string' && amountNeeded.includes('%');

        const foodPlants = Object.entries(植物).filter(([plantName, plantInfo]) => {
            if (isPercentage && foodName === plantName) {
                return true;
            }
            return plantInfo[foodName] != null;
        });

        if (foodPlants.length > 0) {
            foodPlants.forEach(([plantName, plantInfo]) => {
                let cycle = wildPlant ? plantInfo["生长周期"][1] : plantInfo["生长周期"][0];
                if (fertilization && plantName !== "米虱木") cycle /= 2;

                let plantCount;
                let resourceConsumption = [];

                if (isPercentage && foodName === plantName) {
                    const percentage = parseFloat(amountNeeded) / 100;
                    const plantOutputPerCycle = 1 / cycle;
                    plantCount = parseFloat((critterNumber * percentage) / plantOutputPerCycle).toFixed(2);
                } else {
                    const totalOutputNeededPerCycle = parseFloat(amountNeeded);
                    const plantOutputPerCycle = plantInfo[foodName] / cycle;
                    plantCount = parseFloat(totalOutputNeededPerCycle / plantOutputPerCycle).toFixed(2);
                }

                if (plantInfo["人工培育"]) {
                    Object.entries(plantInfo["人工培育"]).forEach(([action, resources]) => {
                        Object.entries(resources).forEach(([resourceName, resourceAmount]) => {
                            let consumptionPerCycle = resourceAmount[wildPlant ? 1 : 0] * plantCount;
                            resourceConsumption.push({
                                资源: resourceName,
                                数量: parseFloat(consumptionPerCycle).toFixed(2),
                                单位: "千克/周期"
                            });
                        });
                    });
                }

                let displayName;
                if (isPercentage && foodName === plantName) {
                    displayName = `${plantName}（植物本身）`;
                } else {
                    displayName = `${foodName}`;
                }

                sources.push({
                    名称: displayName,
                    数量: plantCount,
                    单位: "株",
                    来源: [...newPath, plantName],
                    资源消耗: resourceConsumption.length > 0 ? resourceConsumption : null
                });
            });
            return sources;
        }

        if (食物[foodName]) {
            sources.push({
                名称: foodName,
                数量: parseFloat(amountNeeded).toFixed(2),
                单位: "千克/周期",
                路径: newPath,
                类型: "食物"
            });
            return sources;
        }

        sources.push({
            名称: foodName,
            数量: parseFloat(amountNeeded).toFixed(2),
            单位: "千克/周期",
            路径: newPath,
            类型: "矿物/材料"
        });

        return sources;
    };

    const calculateRequirements = () => {
        if (!selectedCritter || !动物[selectedCritter]) {
            setResult([]);
            return;
        }

        let calcResult = [];
        const critterInfo = 动物[selectedCritter];

        if (!critterInfo.食物 || critterInfo.食物.length === 0) {
            setResult([]);
            return;
        }

        critterInfo.食物.forEach((foodOption, optionIndex) => {
            let optionResult = {
                name: `食物选项 ${optionIndex + 1}`,
                ingredients: [],
                outputs: []
            };

            const processFoodOption = (option) => {
                if (Array.isArray(option)) {
                    if (option.length === 4) {
                        const [food, amount, output, outputAmount] = option;
                        let totalFoodNeeded;

                        if (typeof amount === 'string' && amount.includes('%')) {
                            totalFoodNeeded = amount;
                        } else {
                            totalFoodNeeded = parseFloat(amount) * critterNumber;
                        }

                        const foodSources = findFoodSources(food, totalFoodNeeded);
                        optionResult.ingredients.push(...foodSources);

                        if (output && outputAmount) {
                            optionResult.outputs.push({
                                名称: output,
                                数量: parseFloat(outputAmount) * critterNumber,
                                单位: "千克/周期",
                                类型: "产出"
                            });
                        }
                    } else if (option.length === 2) {
                        const [food, amount] = option;
                        let totalFoodNeeded;

                        if (typeof amount === 'string' && amount.includes('%')) {
                            totalFoodNeeded = amount;
                        } else {
                            totalFoodNeeded = parseFloat(amount) * critterNumber;
                        }

                        const foodSources = findFoodSources(food, totalFoodNeeded);
                        optionResult.ingredients.push(...foodSources);
                    }
                } else if (typeof option === 'string') {
                    const foodSources = findFoodSources(option, critterNumber);
                    optionResult.ingredients.push(...foodSources);
                }
            };

            if (Array.isArray(foodOption) && foodOption.length > 0 && Array.isArray(foodOption[0])) {
                foodOption.forEach(option => processFoodOption(option));
            } else {
                processFoodOption(foodOption);
            }

            if (optionResult.ingredients.length > 0 || optionResult.outputs.length > 0) {
                calcResult.push(optionResult);
            }
        });

        setResult(calcResult);
    };

    React.useEffect(() => {
        calculateRequirements();
    }, [critterNumber, selectedCritter, wildPlant, fertilization]);

    const getIconForName = (name) => {
        // 处理包含 "（植物本身）" 的情况
        const cleanName = name.replace(/（植物本身）/, '');

        if (name.includes(" → ")) {
            const parts = name.split(" → ");
            const sourceName = parts[0].replace(/（植物本身）/, '');
            const materialName = parts[1].replace(/（植物本身）/, '');

            return 图片[sourceName] || 图片[materialName];
        }

        return 图片[cleanName] || 图片[name];
    };

    const categories = React.useMemo(() => {
        const allCategories = new Set();
        Object.values(动物).forEach(animal => {
            if (animal.分类) {
                allCategories.add(animal.分类);
            }
        });
        return ["全部", ...Array.from(allCategories).sort()];
    }, []);

    const filteredAnimals = React.useMemo(() => {
        if (activeCategory === "全部") {
            return Object.entries(动物);
        }
        return Object.entries(动物).filter(([_, animal]) => animal.分类 === activeCategory);
    }, [activeCategory]);

    return (
        <div className="calculator-container">
            <div className="header">
                <button className="back-button" onClick={goToHome} title="返回首页">🏠 返回首页</button>
                <button className="theme-toggle" onClick={toggleTheme} title="切换主题">
                    {isDarkTheme ? '☀️' : '🌙'}
                </button>
                <h1>🐾 小动物养殖计算器</h1>
                <p>计算缺氧中小动物的食物需求和产出，优化你的养殖系统</p>
            </div>

            <div className="content">
                <div className="section">
                    <div className="section-title">🐄 养殖配置</div>
                    <div className="input-group">
                        <label>小动物数量:</label>
                        <input
                            type="number"
                            step="1"
                            min="1"
                            value={critterNumber}
                            onChange={e => setCritterNumber(parseInt(e.target.value))}
                        />
                    </div>
                </div>

                <div className="section">
                    <div className="section-title">🌱 植物配置</div>
                    <div className="checkbox-group">
                        <div className="checkbox-item">
                            <input
                                type="checkbox"
                                id="植物野生"
                                checked={wildPlant}
                                onChange={e => setWildPlant(e.target.checked)}
                            />
                            <label htmlFor="植物野生">植物野生</label>
                        </div>
                        <div className="checkbox-item">
                            <input
                                type="checkbox"
                                id="施肥"
                                checked={fertilization}
                                onChange={e => setFertilization(e.target.checked)}
                            />
                            <label htmlFor="施肥">施肥加速</label>
                        </div>
                    </div>
                </div>

                <div className="section">
                    <div className="section-title">🦌 选择小动物</div>
                    <div className="category-tabs" style={{
                        display: 'flex',
                        flexWrap: 'wrap',
                        gap: '10px',
                        padding: '15px',
                        background: 'var(--bg-tertiary)',
                        borderRadius: '10px',
                        justifyContent: 'left'
                    }}>
                        {categories.map(category => {
                            const categoryIcon = 图片[category];
                            return (
                                <button
                                    key={category}
                                    className={`category-tab ${activeCategory === category ? 'active' : ''}`}
                                    onClick={() => setActiveCategory(category)}
                                    style={{
                                        display: 'flex',
                                        alignItems: 'center',
                                        gap: '8px',
                                        padding: '10px 16px',
                                        border: `2px solid ${activeCategory === category ? 'var(--accent-primary)' : 'var(--border-color)'}`,
                                        borderRadius: '25px',
                                        background: activeCategory === category ? 'var(--accent-primary)' : 'var(--bg-card)',
                                        color: activeCategory === category ? 'white' : 'var(--text-primary)',
                                        cursor: 'pointer',
                                        transition: 'all 0.3s ease',
                                        fontSize: '0.9em',
                                        fontWeight: '500',
                                        minWidth: '120px',
                                        justifyContent: 'center'
                                    }}
                                >
                                    {categoryIcon && (
                                        <img
                                            src={categoryIcon}
                                            alt={category}
                                            style={{
                                                width: '20px',
                                                height: '20px',
                                                objectFit: 'contain',
                                                borderRadius: '2px'
                                            }}
                                        />
                                    )}
                                    <span>{category}</span>
                                </button>
                            );
                        })}
                    </div>

                    <div className="animals-grid" style={{
                        display: 'grid',
                        gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))',
                        gap: '12px',
                        maxHeight: '400px',
                        overflowY: 'auto',
                        padding: '15px',
                        background: 'var(--bg-tertiary)',
                        borderRadius: '10px'
                    }}>
                        {filteredAnimals.map(([animalName, animalInfo]) => {
                            const categoryIcon = 图片[animalInfo.分类];
                            return (
                                <label key={animalName} className="animal-radio-item" style={{
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '12px',
                                    padding: '12px',
                                    background: 'var(--bg-card)',
                                    border: `2px solid ${selectedCritter === animalName ? 'var(--accent-primary)' : 'var(--border-color)'}`,
                                    borderRadius: '8px',
                                    cursor: 'pointer',
                                    transition: 'all 0.3s ease',
                                    minHeight: '70px',
                                    position: 'relative'
                                }}>
                                    <input
                                        type="radio"
                                        name="animal"
                                        value={animalName}
                                        checked={selectedCritter === animalName}
                                        onChange={(e) => setSelectedCritter(e.target.value)}
                                        style={{ display: 'none' }}
                                    />
                                    {图片[animalName] && (
                                        <img
                                            src={图片[animalName]}
                                            alt={animalName}
                                            style={{
                                                width: '45px',
                                                height: '45px',
                                                objectFit: 'contain',
                                                borderRadius: '4px',
                                                flexShrink: '0'
                                            }}
                                        />
                                    )}
                                    <div style={{ flex: '1' }}>
                                        <div style={{
                                            fontWeight: '600',
                                            color: 'var(--text-primary)',
                                            fontSize: '0.95em',
                                            marginBottom: '4px'
                                        }}>
                                            {animalName}
                                        </div>
                                        <div style={{
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '6px',
                                            fontSize: '0.75em',
                                            color: 'var(--text-muted)',
                                            opacity: '0.8'
                                        }}>
                                            {categoryIcon && (
                                                <img
                                                    src={categoryIcon}
                                                    alt={animalInfo.分类}
                                                    style={{
                                                        width: '14px',
                                                        height: '14px',
                                                        objectFit: 'contain',
                                                        borderRadius: '1px'
                                                    }}
                                                />
                                            )}
                                            <span>{animalInfo.分类}</span>
                                        </div>
                                    </div>
                                    {selectedCritter === animalName && (
                                        <div style={{
                                            position: 'absolute',
                                            top: '8px',
                                            right: '8px',
                                            width: '12px',
                                            height: '12px',
                                            borderRadius: '50%',
                                            background: 'var(--accent-primary)',
                                            border: '2px solid var(--bg-card)'
                                        }} />
                                    )}
                                </label>
                            );
                        })}
                    </div>
                </div>

                {result && result.length > 0 && (
                    <div className="results-section">
                        <div className="results-title">📊 养殖需求计算结果</div>
                        <div className="results-grid">
                            {result.map((item, idx1) => (
                                <div key={"group_"+idx1} className="result-card">
                                    <div className="card-header">
                                        <div className="card-title">{item.name}</div>
                                        {/*<div className="card-stats">
                                            <span className="stat-ingredient">
                                                📥 {item.ingredients.length} 种原料
                                            </span>
                                            <span className="stat-output">
                                                📤 {item.outputs.length} 种产出
                                            </span>
                                        </div>*/}
                                    </div>

                                    <div className="card-content">
                                        {item.ingredients.length > 0 && (
                                            <div className="requirements-section">
                                                <div className="section-title">🍽️ 原料需求</div>
                                                <div className="requirements-list">
                                                    {item.ingredients.map((recipe, idx2) => {
                                                        const iconUrl = getIconForName(recipe["名称"]);
                                                        return (
                                                            <div key={"ingredient_"+idx1+"_"+idx2} className="requirement-item">
                                                                <div className="requirement-main">
                                                                    <div className="requirement-icon">
                                                                        {iconUrl && (
                                                                            <img src={iconUrl} alt={recipe["名称"]} />
                                                                        )}
                                                                    </div>
                                                                    <div className="requirement-info">
                                                                        <div className="requirement-name">{recipe["名称"]}</div>
                                                                        <div className="requirement-amount">
                                                                            {recipe["数量"]} {recipe["单位"]}
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                {recipe.来源 && (
                                                                    <div className="requirement-source">
                                                                        <span className="source-label">来源:</span>
                                                                        <div className="source-path">
                                                                            {recipe.来源.reverse().map((item, index) => {
                                                                                const pathIcon = getIconForName(item);
                                                                                return (
                                                                                    <span key={index} className="path-step">
                                                                                        {pathIcon && (
                                                                                            <img src={pathIcon} alt={item} />
                                                                                        )}
                                                                                        {item}
                                                                                        {index < recipe.来源.length - 1 && " → "}
                                                                                    </span>
                                                                                );
                                                                            })}
                                                                        </div>
                                                                    </div>
                                                                )}

                                                                {recipe.资源消耗 && recipe.资源消耗.length > 0 && (
                                                                    <div className="resource-requirements">
                                                                        <div className="resource-label">资源消耗:</div>
                                                                        <div className="resource-list">
                                                                            {recipe.资源消耗.map((resource, idx) => (
                                                                                <div key={idx} className="resource-item">
                                                                                    {resource.资源}: {resource.数量} {resource.单位}
                                                                                </div>
                                                                            ))}
                                                                        </div>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        )}

                                        <div className="outputs-section">
                                            <div className="section-title">🎯 产出物品</div>
                                            <div className="outputs-list">
                                                {item.outputs.length > 0 ? (
                                                    item.outputs.map((output, idx2) => {
                                                        const iconUrl = getIconForName(output["名称"]);
                                                        return (
                                                            <div key={"output_"+idx1+"_"+idx2} className="output-item">
                                                                <div className="output-icon">
                                                                    {iconUrl && (
                                                                        <img src={iconUrl} alt={output["名称"]} />
                                                                    )}
                                                                </div>
                                                                <div className="output-info">
                                                                    <div className="output-name">{output["名称"]}</div>
                                                                    <div className="output-amount">
                                                                        {output["数量"].toFixed(3)} {output["单位"]}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        );
                                                    })
                                                ) : (
                                                    <div className="no-outputs">
                                                        🐾 无额外产出物品
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                )}
                {selectedCritter && result.length === 0 && (
                    <div className="no-results">
                        🎉 这个小动物不需要额外食物或是基础食物！
                    </div>
                )}
            </div>
        </div>
    );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<CritterCalculator />);
</script>
</body>
</html>