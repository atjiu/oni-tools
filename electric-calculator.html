<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>缺氧发电计算器</title>
    <!-- <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> -->
    <script src="./js/react-development-18.3.1.js"></script>
    <script src="./js/react-dom-development-18.3.1.js"></script>
    <script src="./js/babel-min-7.28.4.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
function ElectricCalculator() {

    // 原油高温转石油比例1:1
    // 石油高温转高硫天然气比例1:1
    // 高硫天然气低温转天然气和硫比例1:0.67:0.33
    // 污染蒸馏转成水泥土比例1:0.99:0.01

    const CYCLE_TO_SECOND = 600;

    const [machine, setMachine] = React.useState("捕草发电");
    const [result, setResult] = React.useState();
    const [土星动物捕草数量, set土星动物捕草数量] = React.useState(1);
    const [油井数量, set油井数量] = React.useState(1);
    const [污染水处理方式, set污染水处理方式] = React.useState("不处理");
    const [二氧化碳处理方式, set二氧化碳处理方式] = React.useState("不处理");
    const [浮油生物种类, set浮油生物种类] = React.useState("浮油生物");
    const [石油发电机数量, set石油发电机数量] = React.useState(1);
    const [植物野生, set植物野生] = React.useState(false);
    const [人工收获, set人工收获] = React.useState(true);
    const [施肥加速, set施肥加速] = React.useState(false);

    // 单位：质量：KG，能量：KJ，功率：KW
    const calculateRequirements = () => {
        let 计算结果 = null;
        if (machine == "捕草发电") {
            let 一台氢气发电机功率 = 0.8;
            let 一台氢气发电机消耗氢气_每秒 = 0.1;
            let 一株土星动物捕草产氢气_每秒 = 167/4000;

            let 一株捕草可供氢气发电机数量 = 一株土星动物捕草产氢气_每秒 / 一台氢气发电机消耗氢气_每秒;
            let 一株捕草可输出电力 = 一株捕草可供氢气发电机数量 * 一台氢气发电机功率;
            计算结果 = {
                氢气发电机数量: parseFloat(一株捕草可供氢气发电机数量*土星动物捕草数量).toFixed(2) + "台",
                电力总功率: parseFloat(一株捕草可输出电力*土星动物捕草数量).toFixed(2) + "KW",
                每周期可产电能: parseFloat(一株捕草可输出电力*土星动物捕草数量*CYCLE_TO_SECOND).toFixed(2) + "KJ",
            }
        } else if (machine == "原油裂解发电") {
            /**
             * 二氧化碳参与循环时：
             *  1. 天然气发电机数量 = 2.264433 * 油井数量 / 0.0824625
             *  2. 浮油生物数量 = 0.675 * 天然气发电机数量
             *  参考数据：1台油井 -> 27.457台天然气发电机 18.534只浮油生物
             */
            let 一台油井功率 = 0.24;
            let 一台油井产原油_每秒 = 3.33;
            let 一台油井产天然气_每秒 = 1/30;
            let 一台油井消耗水_每秒 = 1.0;

            let 一台天然气发电机功率 = 0.8;
            let 一台天然气发电机消耗天然气_每秒 = 0.09;
            let 一台天然气发电机排放二氧化碳_每秒 = 0.0225;
            let 一台天然气发电机排放污染水_每秒 = 0.0675;

            let 一只浮油生物消耗二氧化碳_每秒 = 20/600;
            let 一只浮油生物产原油_每秒 = 一只浮油生物消耗二氧化碳_每秒/2;

            let 一只熔岩浮油生物消耗二氧化碳_每秒 = 20/600;
            let 一只熔岩浮油生物产石油_每秒 = 一只熔岩浮油生物消耗二氧化碳_每秒/2;

            let 一台净水器功率 = 0.12;
            let 一台净水器消耗过滤介质_每秒 = 1.0;
            let 一台净水器消耗污染水_每秒 = 5.0;
            let 一台净水器产出水_每秒 = 5.0;
            let 一台净水器产出污染土_每秒 = 0.2;

            let 一台碳素脱离器功率 = 0.12;
            let 一台碳素脱离器消耗水_每秒 = 1.0;
            let 一台碳素脱离器消耗二氧化碳_每秒 = 0.3;
            let 一台碳素脱离器产出污染水_每秒 = 1.0;

            let 一台油井可供天然气发电机数量;
            let 一台油井发电产二氧化碳需要浮油生物数量;

            // 计算一台油井可供应天然气发电机数量
            if (二氧化碳处理方式 == "不处理" || 二氧化碳处理方式 == "碳素脱离器") {
                一台油井可供天然气发电机数量 = (一台油井产原油_每秒 * 0.67 + 一台油井产天然气_每秒) / 一台天然气发电机消耗天然气_每秒;
            } else if (二氧化碳处理方式 == "浮油生物") {
                一台油井可供天然气发电机数量 = 2.264433 / 0.0824625;
                一台油井发电产二氧化碳需要浮油生物数量 = 0.675 * 一台油井可供天然气发电机数量;
            }

            let 一台油井发电产污染水_每秒 = 一台油井可供天然气发电机数量 * 一台天然气发电机排放污染水_每秒;

            计算结果 = {
                天然气发电机数量: parseFloat(一台油井可供天然气发电机数量).toFixed(2) + "台",
                电力总功率: parseFloat(油井数量 * 一台油井可供天然气发电机数量 * 一台天然气发电机功率).toFixed(2) + "KW",
                每周期可产电能: parseFloat(油井数量 * 一台油井可供天然气发电机数量 * 一台天然气发电机功率 * CYCLE_TO_SECOND).toFixed(2) + "KJ",
            };

            // 总结
            if (二氧化碳处理方式 == "不处理") {
                计算结果["产出二氧化碳"] = parseFloat(油井数量 * 一台天然气发电机排放二氧化碳_每秒 * 一台油井可供天然气发电机数量 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
            } else if (二氧化碳处理方式 == "碳素脱离器") {
                let 一台油井产出二氧化碳_每秒 = 一台天然气发电机排放二氧化碳_每秒 * 一台油井可供天然气发电机数量;
                计算结果["碳素脱离器数量"] = parseFloat(一台油井产出二氧化碳_每秒 / 一台碳素脱离器消耗二氧化碳_每秒).toFixed(2) + "台";
                let 一台油井产出污染水_每秒 = 一台天然气发电机排放污染水_每秒 * 一台油井可供天然气发电机数量;
                let 一台油井碳素脱离器产出污染水_每秒 = 一台油井产出二氧化碳_每秒 * 一台碳素脱离器产出污染水_每秒 / 一台碳素脱离器消耗二氧化碳_每秒;
                let 一台油井碳素脱离器消耗水_每秒 = 一台油井产出二氧化碳_每秒 * 一台碳素脱离器消耗水_每秒 / 一台碳素脱离器消耗二氧化碳_每秒;
                计算结果["产出污染水"] = parseFloat(油井数量 * 一台油井产出污染水_每秒 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
                计算结果["消耗水"] = parseFloat(油井数量 * 一台油井碳素脱离器消耗水_每秒 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
            } else if (二氧化碳处理方式 == "浮油生物") {

            }

            if (污染水处理方式 == "不处理") {
                计算结果["消耗水"] = parseFloat(油井数量 * 一台油井消耗水_每秒 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
                计算结果["产出污染水"] = parseFloat(油井数量 * 一台天然气发电机排放污染水_每秒 * 一台油井可供天然气发电机数量 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
            } else if (污染水处理方式 == "净水器") {
                let 一台油井净水器产水_每秒 = 一台油井发电产污染水_每秒 * 一台净水器产出水_每秒 / 一台净水器消耗污染水_每秒;
                计算结果["消耗过滤介质"] = parseFloat(油井数量 * 一台油井发电产污染水_每秒 * 一台净水器消耗过滤介质_每秒 * CYCLE_TO_SECOND / 一台净水器消耗污染水_每秒).toFixed(2) + "KG/周期";
                计算结果["产出污染土"] = parseFloat(油井数量 * 一台油井发电产污染水_每秒 * 一台净水器产出污染土_每秒 * CYCLE_TO_SECOND / 一台净水器消耗污染水_每秒).toFixed(2) + "KG/周期";
                计算结果["水缺口"] = parseFloat((油井数量 * 一台油井消耗水_每秒 - 一台油井净水器产水_每秒) * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
            } else if (污染水处理方式 == "蒸馏") {
                let 一台油井蒸馏产水_每秒 = 一台油井发电产污染水_每秒 * 0.99;
                let 一台油井蒸馏产泥土_每秒 = 一台油井发电产污染水_每秒 * 0.01;
                计算结果["产出泥土"] = parseFloat(油井数量 * 一台油井蒸馏产泥土_每秒 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
                计算结果["水缺口"] = parseFloat((油井数量 * 一台油井消耗水_每秒 - 一台油井蒸馏产水_每秒) * CYCLE_TO_SECOND).toFixed(2) + "KG/周期";
            }

        } else if (machine == "乙醇发电") {
            let 一台石油发电机功率 = 2.0;
            let 一台石油发电机消耗燃料_每秒 = 2.0;
            let 一台石油发电机排放二氧化碳_每秒 = 0.5;
            let 一台石油发电机排放污染水_每秒 = 0.75;

            let 一台原油精炼器功率 = 0.48;
            let 一台原油精炼器消耗原油_每秒 = 10;
            let 一台原油精炼器产出石油_每秒 = 5;
            let 一台原油精炼器产出天然气_每秒 = 0.09;

            // "乔木树": { "生长周期": [4.5, 18], "人工培育": { "灌溉": { "污染水": [70, 0] }, "施肥": { "泥土": [10, 0] } }, "木材": { "数量": 1500 } },
            // 植物野生 人工收获 施肥加速

            // 周期计算
            let 一棵乔木树生长周期 = 4.5
            let 一棵乔木树消耗污染水_每秒 = 7/60;
            let 一棵乔木树消耗泥土_每秒 = 1/60;
            if (植物野生) 一棵乔木树生长周期 *= 4;
            if (施肥加速) 一棵乔木树生长周期 /= 2;
            if (!人工收获) 一棵乔木树生长周期 += 4;
            // 产量计算
            let 一棵乔木树产木材_每秒 = 1500 / (一棵乔木树生长周期 * CYCLE_TO_SECOND);

            let 一台乙醇蒸馏器消耗木材_每秒 = 1.0;
            let 一台乙醇蒸馏器产出乙醇_每秒 = 0.5;
            let 一台乙醇蒸馏器产出污染土_每秒 = 0.33333;
            let 一台乙醇蒸馏器产出二氧化碳_每秒 = 0.16667;

            let 一台石油发电机需要乙醇蒸馏器数量 = 一台石油发电机消耗燃料_每秒 / 一台乙醇蒸馏器产出乙醇_每秒;
            let 一台石油发电机需要乔木树数量 = 一台石油发电机需要乙醇蒸馏器数量 * 一台乙醇蒸馏器消耗木材_每秒 / 一棵乔木树产木材_每秒;
            let 一台石油发电机污染水缺口_每秒 = 一台石油发电机需要乔木树数量 * 一棵乔木树消耗污染水_每秒 - 一台石油发电机排放污染水_每秒;

            计算结果 = {
                乙醇蒸馏器数量: parseFloat(石油发电机数量 * 一台石油发电机需要乙醇蒸馏器数量).toFixed(2) + "台",
                乔木树数量: parseFloat(石油发电机数量 * 一台石油发电机需要乔木树数量).toFixed(2) + "棵",
                污染水缺口: parseFloat(石油发电机数量 * 一台石油发电机污染水缺口_每秒 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期",
                消耗泥土: parseFloat(石油发电机数量 * 一棵乔木树消耗泥土_每秒 * 一台石油发电机需要乔木树数量 * CYCLE_TO_SECOND).toFixed(2) + "KG/周期",
                产出二氧化碳: parseFloat(石油发电机数量 * 一台石油发电机需要乙醇蒸馏器数量 * 一台乙醇蒸馏器产出二氧化碳_每秒).toFixed(2) + "KG/周期",
                产出污染土: parseFloat(石油发电机数量 * 一台石油发电机需要乙醇蒸馏器数量 * 一台乙醇蒸馏器产出污染土_每秒).toFixed(2) + "KG/周期",
                电力总功率: parseFloat(石油发电机数量 * 一台石油发电机功率).toFixed(2) + "KW",
                每周期可产电能: parseFloat(石油发电机数量 * 一台石油发电机功率 * CYCLE_TO_SECOND).toFixed(2) + "KJ",
            }
        }
        setResult(计算结果);
    }
    React.useEffect(() => {
        calculateRequirements();
    }, [machine, 土星动物捕草数量, 油井数量, 污染水处理方式, 二氧化碳处理方式, 浮油生物种类, 石油发电机数量, 植物野生, 人工收获, 施肥加速]);
    return <div>
        <div>
            <div>发电设备</div>
            <input type="radio" name="发电设备" id="捕草发电" value="捕草发电" checked={machine == "捕草发电"} onChange={e => setMachine(e.target.value)}/><label htmlFor="捕草发电">捕草发电</label>
            <input type="radio" name="发电设备" id="原油裂解发电" value="原油裂解发电" checked={machine == "原油裂解发电"} onChange={e => setMachine(e.target.value)}/><label htmlFor="原油裂解发电">原油裂解发电</label>
            <input type="radio" name="发电设备" id="乙醇发电" value="乙醇发电" checked={machine == "乙醇发电"} onChange={e => setMachine(e.target.value)}/><label htmlFor="乙醇发电">乙醇发电</label>
        </div>

        {machine == "捕草发电" &&
            <div>
                <label>土星动物捕草数量</label> <input type="number" min="1" step="1" value={土星动物捕草数量} onChange={e=>set土星动物捕草数量(Number(e.target.value))}/>
            </div>
        }
        {machine == "原油裂解发电" &&
            <div>
                <label>油井数量</label> <input type="number" min="1" step="1" value={油井数量} onChange={e=>set油井数量(Number(e.target.value))}/>
                <div>
                    <label>二氧化碳处理方式：</label>
                    <input type="radio" name="二氧化碳处理方式" id="不处理_二氧化碳" value="不处理" checked={二氧化碳处理方式 == "不处理"} onChange={e=>set二氧化碳处理方式(e.target.value)} /> <label htmlFor="不处理_二氧化碳">不处理</label>
                    <input type="radio" name="二氧化碳处理方式" id="碳素脱离器" value="碳素脱离器" checked={二氧化碳处理方式 == "碳素脱离器"} onChange={e=>set二氧化碳处理方式(e.target.value)} /> <label htmlFor="碳素脱离器">碳素脱离器</label>
                    <input type="radio" name="二氧化碳处理方式" id="浮油生物" value="浮油生物" checked={二氧化碳处理方式 == "浮油生物"} onChange={e=>set二氧化碳处理方式(e.target.value)} /> <label htmlFor="浮油生物">浮油生物</label>
                </div>
                {二氧化碳处理方式 == "浮油生物" && <div>
                    <div>
                        <label>浮油生物种类：</label>
                        <input type="radio" name="浮油生物种类" id="种类_浮油生物" value="浮油生物" checked={浮油生物种类 == "浮油生物"} onChange={e=>set浮油生物种类(e.target.value)} /> <label htmlFor="种类_浮油生物">浮油生物</label>
                        <input type="radio" name="浮油生物种类" id="种类_熔岩浮油生物" value="熔岩浮油生物" checked={浮油生物种类 == "熔岩浮油生物"} onChange={e=>set浮油生物种类(e.target.value)} /> <label htmlFor="种类_熔岩浮油生物">熔岩浮油生物</label>
                    </div>
                </div>}
                <div>
                    <label>污染水处理方式：</label>
                    <input type="radio" name="污染水处理方式" id="不处理_污染水" value="不处理" checked={污染水处理方式 == "不处理"} onChange={e=>set污染水处理方式(e.target.value)} /> <label htmlFor="不处理_污染水">不处理</label>
                    <input type="radio" name="污染水处理方式" id="净水器" value="净水器" checked={污染水处理方式 == "净水器"} onChange={e=>set污染水处理方式(e.target.value)} /> <label htmlFor="净水器">净水器</label>
                    <input type="radio" name="污染水处理方式" id="蒸馏" value="蒸馏" checked={污染水处理方式 == "蒸馏"} onChange={e=>set污染水处理方式(e.target.value)} /> <label htmlFor="蒸馏">蒸馏</label>
                </div>
            </div>
        }
        {machine == "乙醇发电" &&
            <div>
                <label>石油发电机数量</label> <input type="number" min="1" step="1" value={石油发电机数量} onChange={e=>set石油发电机数量(Number(e.target.value))}/>
                <div>
                    <label>农业配置</label>
                    <input type="checkbox" id="植物野生" value={植物野生} checked={植物野生} onChange={e=>set植物野生(e.target.checked)} /> <label htmlFor="植物野生">植物野生</label>
                    <input type="checkbox" id="人工收获" value={人工收获} checked={人工收获} onChange={e=>set人工收获(e.target.checked)} /> <label htmlFor="人工收获">人工收获</label>
                    <input type="checkbox" id="施肥加速" value={施肥加速} checked={施肥加速} onChange={e=>set施肥加速(e.target.checked)} /> <label htmlFor="施肥加速">施肥加速</label>
                </div>
            </div>
        }
        {result && Object.keys(result).map((key, index) => <div key={index}>
            {key}: {result[key]}
        </div>)}
    </div>
}
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<ElectricCalculator />);
</script>
</body>
</html>