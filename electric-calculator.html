<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>缺氧发电计算器</title>
    <!-- <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> -->
    <script src="./js/react-development-18.3.1.js"></script>
    <script src="./js/react-dom-development-18.3.1.js"></script>
    <script src="./js/babel-min-7.28.4.js"></script>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
function ElectricCalculator() {
    // 数据单位：周期、KW、KG
    // 1周期600秒
    const CYCLE_TO_SECOND = 600;
    const 发电机 = {
        "人力发电机": {"功率": 0.4},
        "煤炭发电机": {
            "功率": 0.6,
            "资源用量": [
                {"消耗": {"煤炭": 1.0}, "排放": [{"二氧化碳": 0.02}]},
            ]
        },
        "天然气发电机": {
            "功率": 0.8,
            "资源用量": [
                {"消耗": {"天然气": 0.09}, "排放": [{"污染水": 0.0675}, {"二氧化碳": 0.0225}]},
            ]
        },
        "氢气发电机": {
            "功率": 0.8,
            "资源用量": [
                {"消耗": {"氢气": 0.1}}
            ],
        },
        "石油发电机": {
            "功率": 2.0,
            "资源用量": [
                {"消耗": {"石油": 2.0}, "排放": [{"二氧化碳": 0.5}, {"污染水": 0.75}]},
                {"消耗": {"乙醇": 2.0}, "排放": [{"二氧化碳": 0.5}, {"污染水": 0.75}]},
                {"消耗": {"生物柴油": 2.0}, "排放": [{"二氧化碳": 0.5}, {"污染水": 0.75}]},
            ]
        },
    };
    const 动物 = {
        "好吃哈奇": {"食物": [["沙子","140kg","煤炭","70kg"],["砂岩","140kg","煤炭","70kg"],["粘土","140kg","煤炭","70kg"],["碎岩","140kg","煤炭","70kg"],["泥土","140kg","煤炭","70kg"],["沉积岩","140kg","煤炭","70kg"],["页岩","140kg","煤炭","70kg"],["营养棒","0.875kg","煤炭","0.6562kg"],["软泥膏","0.875kg","煤炭","0.6562kg"],["米虱","1.2kg","煤炭","0.875kg"],["漫花果","2.2kg","煤炭","1.6kg"],["淤泥根","0.875kg","煤炭","0.6562kg"],["六角根果实","0.1094kg","煤炭","0.082kg"],["沼泽甜菜心","0.2917kg","煤炭","0.2187kg"],["雪莓","0.875kg","煤炭","0.6562kg"],["蘑菇","0.2917kg","煤炭","0.2187kg"],["海生菜","1.7kg","煤炭","1.3kg"],["生蛋","0.4375kg","煤炭","0.3281kg"],["肉","0.4375kg","煤炭","0.3281kg"],["植物肉","0.5833kg","煤炭","0.4375kg"],["毛刺浆果","0.4375kg","煤炭","0.3281kg"],["沼浆果冻","0.3804kg","煤炭","0.2853kg"],["帕库鱼片","0.7kg","煤炭","0.525kg"],["生蟹肉","0.7kg","煤炭","0.525kg"],["颚鱼片","0.7kg","煤炭","0.525kg"],["贫瘠虫果","0.875kg","煤炭","0.6562kg"],["虫果","2.8kg","煤炭","2.1kg"],["刺壳果","0.875kg","煤炭","0.6562kg"],["羽叶果薯","0.175kg","煤炭","0.1312kg"],["干肉饼","0.2692kg","煤炭","0.2019kg"],["果薯条","0.1296kg","煤炭","0.0972kg"],["烘烤拟种","0.4667kg","煤炭","0.35kg"],["炸肉块","0.175kg","煤炭","0.1312kg"],["炸豆小吃","0.14kg","煤炭","0.105kg"],["鱼肉卷","0.1667kg","煤炭","0.125kg"],["蟹肉天妇罗","0.1667kg","煤炭","0.125kg"],["汗甜玉米","0.875kg","煤炭","0.6562kg"],["菌斑果","0.875kg","煤炭","0.6562kg"],["腌制米虱","0.3889kg","煤炭","0.2917kg"],["米虱糕","0.4118kg","煤炭","0.3088kg"],["煎泥膏","0.6667kg","煤炭","0.5kg"],["炙烤刺果","0.35kg","煤炭","0.2625kg"],["沼泽欢愉","0.3125kg","煤炭","0.2344kg"],["煎蘑菇","0.25kg","煤炭","0.1875kg"],["刺壳果烤串","0.5833kg","煤炭","0.4375kg"],["冰霜面包","0.5833kg","煤炭","0.4375kg"],["煎蛋卷","0.25kg","煤炭","0.1875kg"],["烤海鲜","0.4375kg","煤炭","0.3281kg"],["爆米花","0.2445kg","煤炭","0.1834kg"],["蛋奶酥煎饼","0.1944kg","煤炭","0.1458kg"],["熏鱼","0.25kg","煤炭","0.1875kg"],["烤肉串","0.175kg","煤炭","0.1312kg"],["嫩肋排","0.14kg","煤炭","0.105kg"],["烤虫果仁","0.5833kg","煤炭","0.4375kg"],["虫果果酱","0.2917kg","煤炭","0.2187kg"],["浆果糕","0.175kg","煤炭","0.1312kg"],["浆果酿","0.1591kg","煤炭","0.1193kg"],["海陆双拼","0.1167kg","煤炭","0.0875kg"],["蘑菇卷","0.1458kg","煤炭","0.1094kg"],["豆腐","0.1944kg","煤炭","0.1458kg"],["咖喱豆","0.14kg","煤炭","0.105kg"],["火椒面包","0.175kg","煤炭","0.1312kg"],["麻婆豆腐","0.175kg","煤炭","0.1312kg"],["蘑菇乳蛋饼","0.1094kg","煤炭","0.082kg"],["混合浆果派","0.1667kg","煤炭","0.125kg"],["冰霜汉堡","0.1167kg","煤炭","0.0875kg"]], "图片":"https://oxygennotincluded.wiki.gg/zh/images/thumb/%E5%A5%BD%E5%90%83%E5%93%88%E5%A5%87.png/34px-%E5%A5%BD%E5%90%83%E5%93%88%E5%A5%87.png?e601a2"},
        "石壳哈奇": {"食物": [["沉积岩","140kg","煤炭","70kg"],["火成岩","140kg","煤炭","70kg"],["黑曜石","140kg","煤炭","70kg"],["花岗岩","140kg","煤炭","70kg"],["铜矿","140kg","煤炭","35kg"],["钴矿","140kg","煤炭","35kg"],["铝矿","140kg","煤炭","35kg"],["镍矿","140kg","煤炭","35kg"],["朱砂矿","140kg","煤炭","35kg"],["铁矿","140kg","煤炭","35kg"],["金汞齐","140kg","煤炭","35kg"],["黑钨矿","140kg","煤炭","35kg"]], "图片":"https://oxygennotincluded.wiki.gg/zh/images/thumb/%E7%9F%B3%E5%A3%B3%E5%93%88%E5%A5%87.png/32px-%E7%9F%B3%E5%A3%B3%E5%93%88%E5%A5%87.png?c27fc9"},
        "草质哈奇": {"食物": [["泥土","140kg","煤炭","140kg"],["菌泥","140kg","煤炭","140kg"],["藻类","140kg","煤炭","140kg"],["肥料","140kg","煤炭","140kg"],["污染土","140kg","煤炭","140kg"],["营养棒","0.875kg","煤炭","0.875kg"],["软泥膏","0.875kg","煤炭","0.875kg"],["米虱","1.2kg","煤炭","1.2kg"],["漫花果","2.2kg","煤炭","2.2kg"],["淤泥根","0.875kg","煤炭","0.875kg"],["六角根果实","0.1094kg","煤炭","0.1094kg"],["沼泽甜菜心","0.2917kg","煤炭","0.2917kg"],["雪莓","0.875kg","煤炭","0.875kg"],["蘑菇","0.2917kg","煤炭","0.2917kg"],["海生菜","1.7kg","煤炭","1.7kg"],["生蛋","0.4375kg","煤炭","0.4375kg"],["肉","0.4375kg","煤炭","0.4375kg"],["植物肉","0.5833kg","煤炭","0.5833kg"],["毛刺浆果","0.4375kg","煤炭","0.4375kg"],["沼浆果冻","0.3804kg","煤炭","0.3804kg"],["帕库鱼片","0.7kg","煤炭","0.7kg"],["生蟹肉","0.7kg","煤炭","0.7kg"],["颚鱼片","0.7kg","煤炭","0.7kg"],["贫瘠虫果","0.875kg","煤炭","0.875kg"],["虫果","2.8kg","煤炭","2.8kg"],["刺壳果","0.875kg","煤炭","0.875kg"],["羽叶果薯","0.175kg","煤炭","0.175kg"],["干肉饼","0.2692kg","煤炭","0.2692kg"],["果薯条","0.1296kg","煤炭","0.1296kg"],["烘烤拟种","0.4667kg","煤炭","0.4667kg"],["炸肉块","0.175kg","煤炭","0.175kg"],["炸豆小吃","0.14kg","煤炭","0.14kg"],["鱼肉卷","0.1667kg","煤炭","0.1667kg"],["蟹肉天妇罗","0.1667kg","煤炭","0.1667kg"],["汗甜玉米","0.875kg","煤炭","0.875kg"],["菌斑果","0.875kg","煤炭","0.875kg"],["腌制米虱","0.3889kg","煤炭","0.3889kg"],["米虱糕","0.4118kg","煤炭","0.4118kg"],["煎泥膏","0.6667kg","煤炭","0.6667kg"],["炙烤刺果","0.35kg","煤炭","0.35kg"],["沼泽欢愉","0.3125kg","煤炭","0.3125kg"],["煎蘑菇","0.25kg","煤炭","0.25kg"],["刺壳果烤串","0.5833kg","煤炭","0.5833kg"],["冰霜面包","0.5833kg","煤炭","0.5833kg"],["煎蛋卷","0.25kg","煤炭","0.25kg"],["烤海鲜","0.4375kg","煤炭","0.4375kg"],["爆米花","0.2445kg","煤炭","0.2445kg"],["蛋奶酥煎饼","0.1944kg","煤炭","0.1944kg"],["熏鱼","0.25kg","煤炭","0.25kg"],["烤肉串","0.175kg","煤炭","0.175kg"],["嫩肋排","0.14kg","煤炭","0.14kg"],["烤虫果仁","0.5833kg","煤炭","0.5833kg"],["虫果果酱","0.2917kg","煤炭","0.2917kg"],["浆果糕","0.175kg","煤炭","0.175kg"],["浆果酿","0.1591kg","煤炭","0.1591kg"],["海陆双拼","0.1167kg","煤炭","0.1167kg"],["蘑菇卷","0.1458kg","煤炭","0.1458kg"],["豆腐","0.1944kg","煤炭","0.1944kg"],["咖喱豆","0.14kg","煤炭","0.14kg"],["火椒面包","0.175kg","煤炭","0.175kg"],["麻婆豆腐","0.175kg","煤炭","0.175kg"],["蘑菇乳蛋饼","0.1094kg","煤炭","0.1094kg"],["混合浆果派","0.1667kg","煤炭","0.1667kg"],["冰霜汉堡","0.1167kg","煤炭","0.1167kg"]], "图片":"https://oxygennotincluded.wiki.gg/zh/images/thumb/%E8%8D%89%E8%B4%A8%E5%93%88%E5%A5%87.png/33px-%E8%8D%89%E8%B4%A8%E5%93%88%E5%A5%87.png?9f9ef4"},
        "浮油生物": {"食物": [["二氧化碳","20kg","原油","10kg"]], "图片":"https://oxygennotincluded.wiki.gg/zh/images/thumb/%E6%B5%AE%E6%B2%B9%E7%94%9F%E7%89%A9.png/40px-%E6%B5%AE%E6%B2%B9%E7%94%9F%E7%89%A9.png?bd453f"},
        "熔岩浮油生物": {"食物": [["二氧化碳","20kg","石油","10kg"]], "图片":"https://oxygennotincluded.wiki.gg/zh/images/thumb/%E7%86%94%E5%B2%A9%E6%B5%AE%E6%B2%B9%E7%94%9F%E7%89%A9.png/38px-%E7%86%94%E5%B2%A9%E6%B5%AE%E6%B2%B9%E7%94%9F%E7%89%A9.png?6f7faf"},
    };
    const 植物 = {
        "土星动物捕草": {
            "资源用量": [
                {"消耗": {"污染水": 1/60}, "排放": {"氢气": 167/4000}},
            ],
        },
    };
    const 建筑 = {
        "电解器": {
            "耗电": 0.12,
            "资源用量": [
                {"消耗": {"水": 1.0}, "排放": {"氧气": 0.888, "氢气": 0.112}},
            ],
        },
        "油井": {
            "耗电": 0.24,
            "资源用量": [
                {"消耗": {"水": 1.0}, "排放": {"原油": 3.33, "天然气": 1/30}},
            ],
        },
        "净水器": {
            "耗电": 0.12,
            "资源用量": [
                {"消耗": {"过滤介质": 1.0, "污染水": 5.0}, "排放": {"水": 5.0, "污染土": 0.2}},
            ],
        },
        "碳素脱离器": {
            "耗电": 0.12,
            "资源用量": [
                {"消耗": {"水": 1.0, "二氧化碳": 0.3}, "排放": {"污染水": 1.0}},
            ],
        },
    };
    // 原油高温转石油比例1:1
    // 石油高温转高硫天然气比例1:1
    // 高硫天然气低温转天然气和硫比例1:0.67:0.33
    // 污染蒸馏转成水泥土比例1:0.99:0.01
    const 原油_石油 = "1:1";
    const 石油_高硫天然气 = "1:1";
    const 高硫天然气_天然气_硫 = "1:0.67:0.33";
    const 污染蒸馏_水_泥土 = "1:0.99:0.01";

    const [machine, setMachine] = React.useState("人力发电机");
    const [result, setResult] = React.useState([]);
    const [resultType, setResultType] = React.useState("");
    const [污水转化方式, set污水转化方式] = React.useState("净水器");
    const [二氧化碳转化方式, set二氧化碳转化方式] = React.useState("浮油生物");
    const [油井数量, set油井数量] = React.useState(1);

    const calculateRequirements = () => {
        let 结果 = [];
        let 类型 = "";

        if (machine == "煤炭发电机") {
            类型 = "煤电方案";
            const 煤炭消耗速率 = 发电机[machine].资源用量[0].消耗.煤炭 * CYCLE_TO_SECOND;

            for (const [哈奇类型, 数据] of Object.entries(动物)) {
                const 食物列表 = 数据.食物;
                let 类型结果 = [];

                for (const 食物 of 食物列表) {
                    const 产出资源 = 食物[2];
                    if (产出资源 == "煤炭") {
                        const 食物名称 = 食物[0];
                        const 食物消耗量 = parseFloat(食物[1].replace('kg', ''));
                        const 煤炭产量 = parseFloat(食物[3].replace('kg', ''));

                        const 所需哈奇数量 = 煤炭消耗速率 / 煤炭产量;
                        const 所需食物量 = 所需哈奇数量 * 食物消耗量;

                        类型结果.push({
                            产电: (发电机[machine].功率 * CYCLE_TO_SECOND).toFixed(0) + "KJ/周期",
                            食物名称: 食物名称,
                            所需哈奇数量: 所需哈奇数量.toFixed(2),
                            所需食物量: 所需食物量.toFixed(2) + "kg/周期",
                            每只净产煤炭: 煤炭产量 + "kg/周期"
                        });
                    }
                }

                if (类型结果.length > 0) {
                    结果.push({
                        哈奇类型: 哈奇类型,
                        图片: 数据.图片,
                        详细数据: 类型结果
                    });
                }
            }
        } else if (machine == "氢气发电机") {
            类型 = "氢气方案";
            const 氢气消耗速率 = 发电机[machine].资源用量[0].消耗.氢气 * CYCLE_TO_SECOND;

            // 电解器方案
            const 电解器氢气产量 = 建筑.电解器.资源用量[0].排放.氢气 * CYCLE_TO_SECOND;
            const 所需电解器数量 = 氢气消耗速率 / 电解器氢气产量;
            const 电解器水消耗 = 所需电解器数量 * 建筑.电解器.资源用量[0].消耗.水 * CYCLE_TO_SECOND;
            const 电解器耗电 = 所需电解器数量 * 建筑.电解器.耗电 * CYCLE_TO_SECOND;
            const 净发电量 = (发电机[machine].功率 * CYCLE_TO_SECOND) - 电解器耗电;

            结果.push({
                氢气来源: "电解器",
                所需建筑数量: 所需电解器数量.toFixed(2) + "台",
                水消耗: 电解器水消耗.toFixed(2) + "kg/周期",
                建筑耗电: 电解器耗电.toFixed(2) + "KJ/周期",
                净发电量: 净发电量.toFixed(2) + "KJ/周期",
                氧气产量: (所需电解器数量 * 建筑.电解器.资源用量[0].排放.氧气 * CYCLE_TO_SECOND).toFixed(2) + "kg/周期"
            });

            // 土星动物捕草方案
            const 捕草氢气产量 = 植物["土星动物捕草"].资源用量[0].排放.氢气 * CYCLE_TO_SECOND;
            const 所需捕草数量 = 氢气消耗速率 / 捕草氢气产量;
            const 捕草污染水消耗 = 所需捕草数量 * 植物["土星动物捕草"].资源用量[0].消耗.污染水 * CYCLE_TO_SECOND;

            结果.push({
                氢气来源: "土星动物捕草",
                所需建筑数量: 所需捕草数量.toFixed(2) + "株",
                污染水消耗: 捕草污染水消耗.toFixed(2) + "kg/周期",
                建筑耗电: "0KJ/周期",
                净发电量: (发电机[machine].功率 * CYCLE_TO_SECOND).toFixed(2) + "KJ/周期",
                备注: "无额外耗电"
            });
        } else if (machine == "天然气发电机") {
            类型 = "天然气方案";
            const 单台天然气消耗速率 = 发电机[machine].资源用量[0].消耗.天然气 * CYCLE_TO_SECOND; // 0.09 * 600 = 54kg/周期

            // 天然气发电机排放
            const 单台二氧化碳排放速率 = 发电机[machine].资源用量[0].排放[1].二氧化碳 * CYCLE_TO_SECOND; // 0.0225 * 600 = 13.5kg/周期
            const 单台污染水排放速率 = 发电机[machine].资源用量[0].排放[0].污染水 * CYCLE_TO_SECOND; // 0.0675 * 600 = 40.5kg/周期

            // 油井产出计算
            const 油井天然气产量 = 建筑.油井.资源用量[0].排放.天然气 * CYCLE_TO_SECOND; // 20kg/周期
            const 油井原油产量 = 建筑.油井.资源用量[0].排放.原油 * CYCLE_TO_SECOND; // 1998kg/周期
            const 单油井总天然气产量 = 油井天然气产量 + (油井原油产量 * 0.67); // 20 + 1338.66 = 1358.66kg/周期

            // 根据用户输入的油井数量计算总产量
            const 总油井天然气产量 = 油井数量 * 单油井总天然气产量;

            // 计算可供多少台天然气发电机
            const 可供发电机数量 = Math.floor(总油井天然气产量 / 单台天然气消耗速率);

            // 计算实际使用的天然气总量
            const 实际天然气消耗速率 = 可供发电机数量 * 单台天然气消耗速率;
            const 实际二氧化碳排放速率 = 可供发电机数量 * 单台二氧化碳排放速率;
            const 实际污染水排放速率 = 可供发电机数量 * 单台污染水排放速率;

            // 根据二氧化碳转化方式计算
            let 二氧化碳处理方案 = {};
            let 浮油生物天然气贡献 = 0;
            let 所需浮油生物数量 = 0;
            let 所需熔岩浮油生物数量 = 0;
            let 所需碳素脱离器数量 = 0;
            let 碳素脱离器水消耗 = 0;
            let 碳素脱离器污染水产量 = 0;

            if (二氧化碳转化方式 === "浮油生物") {
                const 浮油生物原油产量 = parseFloat(动物.浮油生物.食物[0][3].replace('kg', '')); // 10kg/周期
                const 浮油生物二氧化碳消耗 = parseFloat(动物.浮油生物.食物[0][1].replace('kg', '')); // 20kg/周期

                所需浮油生物数量 = 实际二氧化碳排放速率 / 浮油生物二氧化碳消耗;
                const 浮油生物总原油产量 = 所需浮油生物数量 * 浮油生物原油产量;
                浮油生物天然气贡献 = 浮油生物总原油产量 * 0.67;

                二氧化碳处理方案 = {
                    方式: "浮油生物",
                    数量: 所需浮油生物数量.toFixed(2) + "只",
                    原油产量: 浮油生物总原油产量.toFixed(2) + "kg/周期",
                    天然气贡献: 浮油生物天然气贡献.toFixed(2) + "kg/周期"
                };
            } else if (二氧化碳转化方式 === "熔岩浮油生物") {
                const 熔岩浮油生物石油产量 = parseFloat(动物.熔岩浮油生物.食物[0][3].replace('kg', '')); // 10kg/周期
                const 熔岩浮油生物二氧化碳消耗 = parseFloat(动物.熔岩浮油生物.食物[0][1].replace('kg', '')); // 20kg/周期

                所需熔岩浮油生物数量 = 实际二氧化碳排放速率 / 熔岩浮油生物二氧化碳消耗;
                const 熔岩浮油生物总石油产量 = 所需熔岩浮油生物数量 * 熔岩浮油生物石油产量;
                浮油生物天然气贡献 = 熔岩浮油生物总石油产量 * 0.67;

                二氧化碳处理方案 = {
                    方式: "熔岩浮油生物",
                    数量: 所需熔岩浮油生物数量.toFixed(2) + "只",
                    石油产量: 熔岩浮油生物总石油产量.toFixed(2) + "kg/周期",
                    天然气贡献: 浮油生物天然气贡献.toFixed(2) + "kg/周期"
                };
            } else if (二氧化碳转化方式 === "碳素脱离器") {
                const 碳素脱离器二氧化碳处理量 = 建筑.碳素脱离器.资源用量[0].消耗.二氧化碳 * CYCLE_TO_SECOND; // 0.3 * 600 = 180kg/周期
                所需碳素脱离器数量 = 实际二氧化碳排放速率 / 碳素脱离器二氧化碳处理量;
                碳素脱离器水消耗 = 所需碳素脱离器数量 * 建筑.碳素脱离器.资源用量[0].消耗.水 * CYCLE_TO_SECOND;
                碳素脱离器污染水产量 = 所需碳素脱离器数量 * 建筑.碳素脱离器.资源用量[0].排放.污染水 * CYCLE_TO_SECOND;

                二氧化碳处理方案 = {
                    方式: "碳素脱离器",
                    数量: 所需碳素脱离器数量.toFixed(2) + "台",
                    水消耗: 碳素脱离器水消耗.toFixed(2) + "kg/周期",
                    污染水产量: 碳素脱离器污染水产量.toFixed(2) + "kg/周期"
                };
            }

            // 重新计算所需油井数量（考虑浮油生物的天然气贡献）
            const 油井需要提供的天然气 = 实际天然气消耗速率 - 浮油生物天然气贡献;
            const 修正所需油井数量 = Math.max(0, 油井需要提供的天然气 / 单油井总天然气产量);
            const 修正油井总水消耗 = 修正所需油井数量 * 建筑.油井.资源用量[0].消耗.水 * CYCLE_TO_SECOND;
            const 修正油井总原油产量 = 修正所需油井数量 * 油井原油产量;

            // 根据污水转化方式计算
            let 污水处理方案 = {};
            let 净水器产水量 = 0;
            let 总过滤介质消耗 = 0;
            let 污水处理器耗电 = 0;
            let 所需净水器数量 = 0;
            let 污染蒸馏产水量 = 0;
            let 泥土产量 = 0;

            if (污水转化方式 === "净水器") {
                const 净水器处理能力 = 建筑.净水器.资源用量[0].消耗.污染水 * CYCLE_TO_SECOND; // 3000kg/周期
                所需净水器数量 = 实际污染水排放速率 / 净水器处理能力;
                净水器产水量 = 所需净水器数量 * 建筑.净水器.资源用量[0].排放.水 * CYCLE_TO_SECOND;
                总过滤介质消耗 = 所需净水器数量 * 建筑.净水器.资源用量[0].消耗.过滤介质 * CYCLE_TO_SECOND;
                污水处理器耗电 = 所需净水器数量 * 建筑.净水器.耗电 * CYCLE_TO_SECOND;

                污水处理方案 = {
                    方式: "净水器",
                    数量: 所需净水器数量.toFixed(2) + "台",
                    产水量: 净水器产水量.toFixed(2) + "kg/周期",
                    过滤介质消耗: 总过滤介质消耗.toFixed(2) + "kg/周期"
                };
            } else if (污水转化方式 === "污染蒸馏") {
                // 污染蒸馏：1kg污染水 -> 0.99kg水 + 0.01kg泥土
                污染蒸馏产水量 = 实际污染水排放速率 * 0.99;
                泥土产量 = 实际污染水排放速率 * 0.01;

                污水处理方案 = {
                    方式: "污染蒸馏",
                    产水量: 污染蒸馏产水量.toFixed(2) + "kg/周期",
                    泥土产量: 泥土产量.toFixed(2) + "kg/周期",
                    备注: "需要加热设备"
                };
                净水器产水量 = 污染蒸馏产水量;
            }

            // 计算总水消耗（包括碳素脱离器的水消耗）
            const 总水消耗 = 修正油井总水消耗 + (二氧化碳转化方式 === "碳素脱离器" ? 碳素脱离器水消耗 : 0);

            // 计算总污染水产生（包括碳素脱离器的污染水产量）
            const 总污染水产生 = 实际污染水排放速率 + (二氧化碳转化方式 === "碳素脱离器" ? 碳素脱离器污染水产量 : 0);

            // 计算水资源平衡
            const 水缺口 = Math.max(0, 总水消耗 - 净水器产水量);

            // 建筑耗电
            const 油井总耗电 = 修正所需油井数量 * 建筑.油井.耗电 * CYCLE_TO_SECOND;
            const 碳素脱离器耗电 = 所需碳素脱离器数量 * 建筑.碳素脱离器.耗电 * CYCLE_TO_SECOND;
            const 总建筑耗电 = 油井总耗电 + 污水处理器耗电 + 碳素脱离器耗电;

            // 总发电量和净发电量
            const 总发电量 = 可供发电机数量 * 发电机[machine].功率 * CYCLE_TO_SECOND;
            const 净发电量 = 总发电量 - 总建筑耗电;

            // 副产品统计
            let 总硫产量 = 修正油井总原油产量 * 0.33;
            if (二氧化碳转化方式 === "浮油生物") {
                总硫产量 += 所需浮油生物数量 * parseFloat(动物.浮油生物.食物[0][3].replace('kg', '')) * 0.33;
            } else if (二氧化碳转化方式 === "熔岩浮油生物") {
                总硫产量 += 所需熔岩浮油生物数量 * parseFloat(动物.熔岩浮油生物.食物[0][3].replace('kg', '')) * 0.33;
            }

            结果.push({
                方案名称: "完整资源循环系统",

                // 系统规模
                油井数量: 油井数量 + "台",
                可供天然气发电机数量: 可供发电机数量 + "台",
                单台产电: (发电机[machine].功率 * CYCLE_TO_SECOND).toFixed(0) + "KJ/周期",

                // 处理方式选择
                污水处理方式: 污水转化方式,
                二氧化碳处理方式: 二氧化碳转化方式,

                // 主要建筑需求
                所需油井数量: 修正所需油井数量.toFixed(2) + "台",
                所需净水器数量: 所需净水器数量 > 0 ? 所需净水器数量.toFixed(2) + "台" : "0台",
                所需浮油生物数量: 所需浮油生物数量 > 0 ? 所需浮油生物数量.toFixed(2) + "只" : "0只",
                所需熔岩浮油生物数量: 所需熔岩浮油生物数量 > 0 ? 所需熔岩浮油生物数量.toFixed(2) + "只" : "0只",
                所需碳素脱离器数量: 所需碳素脱离器数量 > 0 ? 所需碳素脱离器数量.toFixed(2) + "台" : "0台",

                // 资源消耗与平衡
                总水消耗: 总水消耗.toFixed(2) + "kg/周期",
                净水器产水量: 净水器产水量.toFixed(2) + "kg/周期",
                水缺口: 水缺口 > 0 ? 水缺口.toFixed(2) + "kg/周期" : "自给自足",
                总过滤介质消耗: 总过滤介质消耗.toFixed(2) + "kg/周期",

                // 能源平衡
                油井总耗电: 油井总耗电.toFixed(2) + "KJ/周期",
                净水器总耗电: 污水处理器耗电.toFixed(2) + "KJ/周期",
                碳素脱离器耗电: 碳素脱离器耗电.toFixed(2) + "KJ/周期",
                总建筑耗电: 总建筑耗电.toFixed(2) + "KJ/周期",
                总发电量: 总发电量.toFixed(2) + "KJ/周期",
                净发电量: 净发电量.toFixed(2) + "KJ/周期",

                // 资源循环利用
                二氧化碳利用: {
                    总排放量: 实际二氧化碳排放速率.toFixed(2) + "kg/周期",
                    处理方式: 二氧化碳处理方案.方式,
                    处理数量: 二氧化碳处理方案.数量,
                    利用率: "100%"
                },
                污染水循环: {
                    总排放量: 总污染水产生.toFixed(2) + "kg/周期",
                    处理方式: 污水处理方案.方式,
                    处理数量: 污水处理方案.数量 || "N/A",
                    循环率: "100%"
                },

                // 产品产出
                天然气产量: 实际天然气消耗速率.toFixed(2) + "kg/周期",
                原油产量: (修正油井总原油产量 + (二氧化碳转化方式 === "浮油生物" ? 所需浮油生物数量 * parseFloat(动物.浮油生物.食物[0][3].replace('kg', '')) : 0)).toFixed(2) + "kg/周期",
                石油产量: (二氧化碳转化方式 === "熔岩浮油生物" ? 所需熔岩浮油生物数量 * parseFloat(动物.熔岩浮油生物.食物[0][3].replace('kg', '')) : 0).toFixed(2) + "kg/周期",
                硫产量: 总硫产量.toFixed(2) + "kg/周期",
                泥土产量: 泥土产量 > 0 ? 泥土产量.toFixed(2) + "kg/周期" : "0kg/周期",

                备注: `${油井数量}台油井可支持${可供发电机数量}台天然气发电机，系统内二氧化碳和污染水100%循环利用`
            });
        }

        setResult(结果);
        setResultType(类型);
    }
    React.useEffect(() => {
        calculateRequirements();
    }, [machine, 污水转化方式, 二氧化碳转化方式, 油井数量]);
    return <div>
        <div>
            <div>发电设备</div>
            <input type="radio" name="发电设备" id="人力发电机" value="人力发电机" checked={machine == "人力发电机"} onChange={e => setMachine(e.target.value)}/><label htmlFor="人力发电机">人力发电机</label>
            <input type="radio" name="发电设备" id="煤炭发电机" value="煤炭发电机" checked={machine == "煤炭发电机"} onChange={e => setMachine(e.target.value)}/><label htmlFor="煤炭发电机">煤炭发电机</label>
            <input type="radio" name="发电设备" id="氢气发电机" value="氢气发电机" checked={machine == "氢气发电机"} onChange={e => setMachine(e.target.value)}/><label htmlFor="氢气发电机">氢气发电机</label>
            <input type="radio" name="发电设备" id="天然气发电机" value="天然气发电机" checked={machine == "天然气发电机"} onChange={e => setMachine(e.target.value)}/><label htmlFor="天然气发电机">天然气发电机</label>
            <input type="radio" name="发电设备" id="石油发电机" value="石油发电机" checked={machine == "石油发电机"} onChange={e => setMachine(e.target.value)}/><label htmlFor="石油发电机">石油发电机</label>
        </div>

        {machine == "人力发电机" &&
            <div>
                <div>产电：{发电机[machine].功率 * CYCLE_TO_SECOND}KJ/周期</div>
                <div>无资源消耗</div>
            </div>
        }

        {machine == "煤炭发电机" && resultType === "煤电方案" &&
            <div>
                <div>产电：{发电机[machine].功率 * CYCLE_TO_SECOND}KJ/周期</div>
                <div>资源消耗：煤炭 {发电机[machine].资源用量[0].消耗.煤炭 * CYCLE_TO_SECOND}kg/周期</div>

                {result.map(哈奇数据 => (
                    <div key={哈奇数据.哈奇类型} style={{margin: '20px 0', padding: '10px', border: '1px solid #ccc'}}>
                        <div style={{display: 'flex', alignItems: 'center', marginBottom: '10px'}}>
                            <img src={哈奇数据.图片} alt={哈奇数据.哈奇类型} style={{width: '32px', height: '32px', marginRight: '10px'}} />
                            <h3>{哈奇数据.哈奇类型}</h3>
                        </div>
                        <ul>
                            {哈奇数据.详细数据.map((食物数据, index) => (
                                <li key={index}>
                                    <div>吃{食物数据.食物名称}需养{食物数据.所需哈奇数量}只，消耗{食物数据.食物名称}{食物数据.所需食物量}</div>
                                </li>
                            ))}
                        </ul>
                    </div>
                ))}
            </div>
        }

        {machine == "氢气发电机" && resultType === "氢气方案" &&
            <div>
                <div>产电：{发电机[machine].功率 * CYCLE_TO_SECOND}KJ/周期</div>
                <div>资源消耗：氢气 {发电机[machine].资源用量[0].消耗.氢气 * CYCLE_TO_SECOND}kg/周期</div>
                {result.map((方案, index) => (
                    <div key={index} style={{margin: '20px 0', padding: '10px', border: '1px solid #ccc'}}>
                        <h3>氢气来源：{方案.氢气来源}</h3>
                        <div>所需数量：{方案.所需建筑数量}</div>
                        {方案.水消耗 && <div>水消耗：{方案.水消耗}</div>}
                        {方案.污染水消耗 && <div>污染水消耗：{方案.污染水消耗}</div>}
                        <div>建筑耗电：{方案.建筑耗电}</div>
                        <div>净发电量：{方案.净发电量}</div>
                        {方案.氧气产量 && <div>氧气产量：{方案.氧气产量}</div>}
                        {方案.备注 && <div>备注：{方案.备注}</div>}
                    </div>
                ))}
            </div>
        }

        {machine == "天然气发电机" && resultType === "天然气方案" &&
            <div>
                <div><label htmlFor="">油井数量</label><input type="number" value={油井数量} onChange={e=>set油井数量(e.target.value)} /></div>
                <div>产电：{发电机[machine].功率 * CYCLE_TO_SECOND}KJ/周期</div>
                <div>资源消耗：天然气 {发电机[machine].资源用量[0].消耗.天然气 * CYCLE_TO_SECOND}kg/周期</div>
                <div>
                    <div>污水转化方式</div>
                    <input type="radio" id="净水器" name="污水转化" checked={污水转化方式 === "净水器"} onChange={e => set污水转化方式("净水器")}/><label htmlFor="净水器">净水器</label>
                    <input type="radio" id="污染蒸馏" name="污水转化" checked={污水转化方式 === "污染蒸馏"} onChange={e => set污水转化方式("污染蒸馏")}/><label htmlFor="污染蒸馏">污染蒸馏</label>
                </div>
                <div>
                    <div>二氧化碳转化方式</div>
                    <input type="radio" id="浮油生物" name="二氧化碳转化" checked={二氧化碳转化方式 === "浮油生物"} onChange={e => set二氧化碳转化方式("浮油生物")}/><label htmlFor="浮油生物">浮油生物</label>
                    <input type="radio" id="熔岩浮油生物" name="二氧化碳转化" checked={二氧化碳转化方式 === "熔岩浮油生物"} onChange={e => set二氧化碳转化方式("熔岩浮油生物")}/><label htmlFor="熔岩浮油生物">熔岩浮油生物</label>
                    <input type="radio" id="碳素脱离器" name="二氧化碳转化" checked={二氧化碳转化方式 === "碳素脱离器"} onChange={e => set二氧化碳转化方式("碳素脱离器")}/><label htmlFor="碳素脱离器">碳素脱离器</label>
                </div>

                {result.map((方案, index) => (
                    <div key={index} style={{margin: '20px 0', padding: '10px', border: '1px solid #ccc'}}>
                        <h3>{方案.方案名称}</h3>

                        <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px'}}>
                            <div>
                                <h4>系统规模：</h4>
                                <div>油井数量：{方案.油井数量}</div>
                                <div>可供天然气发电机：{方案.可供天然气发电机数量}</div>
                                <div>单台产电：{方案.单台产电}</div>
                            </div>

                            <div>
                                <h4>处理方式：</h4>
                                <div>污水处理：{方案.污水处理方式}</div>
                                <div>二氧化碳处理：{方案.二氧化碳处理方式}</div>
                            </div>
                        </div>

                        <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginTop: '15px'}}>
                            <div>
                                <h4>建筑需求：</h4>
                                <div>油井：{方案.所需油井数量}</div>
                                <div>净水器：{方案.所需净水器数量}</div>
                                <div>浮油生物：{方案.所需浮油生物数量}</div>
                                <div>熔岩浮油生物：{方案.所需熔岩浮油生物数量}</div>
                                <div>碳素脱离器：{方案.所需碳素脱离器数量}</div>
                            </div>

                            <div>
                                <h4>资源平衡：</h4>
                                <div>总水消耗：{方案.总水消耗}</div>
                                <div>净水器产水：{方案.净水器产水量}</div>
                                <div>水缺口：{方案.水缺口}</div>
                                <div>过滤介质：{方案.总过滤介质消耗}</div>
                            </div>
                        </div>

                        <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginTop: '15px'}}>
                            <div>
                                <h4>能源平衡：</h4>
                                <div>油井耗电：{方案.油井总耗电}</div>
                                <div>净水器耗电：{方案.净水器总耗电}</div>
                                <div>碳素脱离器耗电：{方案.碳素脱离器耗电}</div>
                                <div>总建筑耗电：{方案.总建筑耗电}</div>
                                <div>总发电量：{方案.总发电量}</div>
                                <div>净发电量：{方案.净发电量}</div>
                            </div>

                            <div>
                                <h4>产品产出：</h4>
                                <div>天然气：{方案.天然气产量}</div>
                                <div>原油：{方案.原油产量}</div>
                                <div>石油：{方案.石油产量}</div>
                                <div>硫：{方案.硫产量}</div>
                                <div>泥土：{方案.泥土产量}</div>
                            </div>
                        </div>

                        <div style={{marginTop: '15px'}}>
                            <h4>资源循环：</h4>
                            <div>二氧化碳：{方案.二氧化碳利用.总排放量} → {方案.二氧化碳利用.处理方式} ({方案.二氧化碳利用.利用率})</div>
                            <div>污染水：{方案.污染水循环.总排放量} → {方案.污染水循环.处理方式} ({方案.污染水循环.循环率})</div>
                        </div>

                        {方案.备注 && <div style={{marginTop: '10px', color: '#666'}}>备注：{方案.备注}</div>}
                    </div>
                ))}
            </div>
        }

        {machine == "石油发电机" &&
            <div>石油发电机 - 功能开发中...</div>
        }
    </div>
}
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<ElectricCalculator />);
</script>
</body>
</html>