<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤åˆ¶äººé£Ÿç‰©éœ€æ±‚è®¡ç®—å™¨</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-secondary: white;
            --bg-tertiary: #f8f9fa;
            --bg-card: white;
            --text-primary: #2c3e50;
            --text-secondary: #34495e;
            --text-muted: #7f8c8d;
            --text-light: #95a5a6;
            --border-color: #e1e8ed;
            --border-light: #ecf0f1;
            --accent-primary: #3498db;
            --accent-secondary: #e74c3c;
            --accent-success: #27ae60;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2d2d2d;
            --bg-card: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --text-muted: #b0b0b0;
            --text-light: #888888;
            --border-color: #404040;
            --border-light: #505050;
            --accent-primary: #4a9fea;
            --accent-secondary: #ff6b6b;
            --accent-success: #2ecc71;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
            --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-secondary);
            border-radius: 15px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
            background: var(--bg-secondary);
            transition: all 0.3s ease;
        }

        .section {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid var(--accent-primary);
            transition: all 0.3s ease;
        }

        .section-title {
            font-size: 1.4em;
            color: var(--text-primary);
            margin-bottom: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .section-title::before {
            content: "â–¶";
            color: var(--accent-primary);
            font-size: 0.8em;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .input-group label {
            font-weight: 500;
            color: var(--text-secondary);
            min-width: 120px;
            transition: all 0.3s ease;
        }

        input[type="number"] {
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
            width: 120px;
            background: var(--bg-card);
            color: var(--text-primary);
        }

        input[type="number"]:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        select {
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1em;
            background: var(--bg-card);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .checkbox-group {
            display: flex;
            gap: 25px;
            flex-wrap: wrap;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px 15px;
            background: var(--bg-card);
            border-radius: 8px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .checkbox-item:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .results-section {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 25px;
            margin-top: 20px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .results-title {
            font-size: 1.3em;
            color: var(--accent-success);
            margin-bottom: 20px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .material-group {
            background: var(--bg-tertiary);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-secondary);
            transition: all 0.3s ease;
        }

        .group-title {
            font-size: 1.2em;
            color: var(--text-primary);
            margin-bottom: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .ingredients-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        .ingredient-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .ingredient-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-light);
            border-color: var(--accent-primary);
        }

        .ingredient-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .ingredient-details {
            color: var(--text-muted);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .ingredient-path {
            font-size: 0.85em;
            color: var(--text-light);
            font-style: italic;
            border-top: 1px dashed var(--border-light);
            padding-top: 8px;
            transition: all 0.3s ease;
        }

        .no-results {
            text-align: center;
            color: var(--text-muted);
            font-style: italic;
            padding: 40px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            .input-group {
                flex-direction: column;
                align-items: flex-start;
            }

            .checkbox-group {
                flex-direction: column;
                gap: 10px;
            }

            .ingredients-grid {
                grid-template-columns: 1fr;
            }

            input[type="number"], select {
                width: 100%;
            }

            .theme-toggle {
                top: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
    // ... é£Ÿç‰©ã€æ¤ç‰©ã€åŠ¨ç‰©æ•°æ®ä¿æŒä¸å˜ ...
    const é£Ÿç‰© = {
        "ç±³è™±": {"èƒ½é‡": 600, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "è‚‰": {"èƒ½é‡": 1600, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "è˜‘è‡": {"èƒ½é‡": 2400, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "æ¯›åˆºæµ†æœ": {"èƒ½é‡": 1600, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "æµ·ç”Ÿèœ": {"èƒ½é‡": 400, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "å¸•åº“é±¼ç‰‡": {"èƒ½é‡": 1000, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "ç”ŸèŸ¹è‚‰": {"èƒ½é‡": 1000, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "ç”Ÿè›‹": {"èƒ½é‡": 1600, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "æ¤ç‰©è‚‰": {"èƒ½é‡": 1200, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "æ²¼æµ†æœå†»": {"èƒ½é‡": 1840, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "è™«æœ": {"èƒ½é‡": 250, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "ç¾½å¶æœè–¯": {"èƒ½é‡": 4000, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "åˆºå£³æœ": {"èƒ½é‡": 800, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "è´«ç˜ è™«æœ": {"èƒ½é‡": 800, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "é¢šé±¼ç‰‡": {"èƒ½é‡": 1000, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},
        "æ±—ç”œç‰ç±³": {"èƒ½é‡": 800, "åˆ¶ä½œæœºå™¨": "ç”Ÿé£Ÿ"},

        "è½¯æ³¥è†": {"èƒ½é‡": 800, "åˆ¶ä½œæœºå™¨": "é£Ÿç‰©å‹åˆ¶å™¨", "é…æ–¹": [[{"æ³¥åœŸ": 75}], [{"æ°´": 75}]]},
        "ç±³è™±ç³•": {"èƒ½é‡": 1700, "åˆ¶ä½œæœºå™¨": "é£Ÿç‰©å‹åˆ¶å™¨", "é…æ–¹": [[{"ç±³è™±": 2}], [{"æ°´": 50}]]},
        "è±†è…": {"èƒ½é‡": 3600, "åˆ¶ä½œæœºå™¨": "é£Ÿç‰©å‹åˆ¶å™¨", "é…æ–¹": [[{"å°åƒè±†": 6}], [{"æ°´": 50}]]},
        "æµ†æœç³•": {"èƒ½é‡": 4000, "åˆ¶ä½œæœºå™¨": "é£Ÿç‰©å‹åˆ¶å™¨", "é…æ–¹": [[{"å†°éœœéº¦ç²’": 5}, {"å·¨è•¨è°·ç²’": 5}], [{"æ¯›åˆºæµ†æœ": 1}, {"åˆºå£³æœ": 2}]]},
        "å¹²è‚‰é¥¼": {"èƒ½é‡": 2600, "åˆ¶ä½œæœºå™¨": "é£Ÿç‰©å‹åˆ¶å™¨", "é…æ–¹": [[{"è‚‰": 1}], [{"åŠ¨ç‰©æ²¹è„‚": 1}]]},

        "è…Œåˆ¶ç±³è™±": {"èƒ½é‡": 1800, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"ç±³è™±": 3}]]},
        "ç…æ³¥è†": {"èƒ½é‡": 1050, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"è½¯æ³¥è†": 1}]]},
        "ç‚™çƒ¤åˆºæœ": {"èƒ½é‡": 2000, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"æ¯›åˆºæµ†æœ": 1}]]},
        "ç…è˜‘è‡": {"èƒ½é‡": 2800, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"è˜‘è‡": 1}]]},
        "å†°éœœé¢åŒ…": {"èƒ½é‡": 1200, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"å†°éœœéº¦ç²’": 3}, {"å·¨è•¨è°·ç²’": 3}]]},
        "ç…è›‹å·": {"èƒ½é‡": 2800, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"ç”Ÿè›‹": 1}]]},
        "çƒ¤è‚‰ä¸²": {"èƒ½é‡": 4000, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"è‚‰": 2}]]},
        "çƒ¤æµ·é²œ": {"èƒ½é‡": 1600, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"å¸•åº“é±¼ç‰‡": 1}, {"ç”ŸèŸ¹è‚‰": 1}]]},
        "è›‹å¥¶é…¥ç…é¥¼": {"èƒ½é‡": 3600, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"ç”Ÿè›‹": 1}], [{"å†°éœœéº¦ç²’": 2}, {"å·¨è•¨è°·ç²’": 2}]]},
        "æ²¼æ³½æ¬¢æ„‰": {"èƒ½é‡": 2240, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"æ²¼æµ†æœå†»": 1}]]},
        "çƒ¤è™«æœä»": {"èƒ½é‡": 1200, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"è´«ç˜ è™«æœ": 1}]]},
        "è™«æœæœé…±": {"èƒ½é‡": 2400, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"è™«æœ": 8}], [{"è”—ç³–": 4}]]},
        "åˆºå£³æœçƒ¤ä¸²": {"èƒ½é‡": 1200, "åˆ¶ä½œæœºå™¨": "ç”µåŠ¨çƒ¤ç‚‰", "é…æ–¹": [[{"åˆºå£³æœ": 1}]]},

        "æµ†æœé…¿": {"èƒ½é‡": 4400, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"ç‚™çƒ¤åˆºæœ": 2}], [{"ç«æ¤’ç²’": 2}]]},
        "è˜‘è‡å·": {"èƒ½é‡": 4800, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"ç…è˜‘è‡": 1}], [{"æµ·ç”Ÿèœ": 4}]]},
        "æµ·é™†åŒæ‹¼": {"èƒ½é‡": 6000, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"çƒ¤è‚‰ä¸²": 1}], [{"çƒ¤æµ·é²œ": 1}]]},
        "ç«æ¤’é¢åŒ…": {"èƒ½é‡": 4000, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"å†°éœœéº¦ç²’": 10}, {"å·¨è•¨è°·ç²’": 10}], [{"ç«æ¤’ç²’": 1}]]},
        "éº»å©†è±†è…": {"èƒ½é‡": 4000, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"è±†è…": 1}], [{"ç«æ¤’ç²’": 1}]]},
        "è˜‘è‡ä¹³è›‹é¥¼": {"èƒ½é‡": 6400, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"ç…è›‹å·": 1}], [{"æµ·ç”Ÿèœ": 1}], [{"ç…è˜‘è‡": 1}]]},
        "å†°éœœæ±‰å ¡": {"èƒ½é‡": 6000, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"å†°éœœé¢åŒ…": 1}], [{"æµ·ç”Ÿèœ": 1}], [{"çƒ¤è‚‰ä¸²": 1}]]},
        "å’–å–±è±†": {"èƒ½é‡": 5000, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"æ»‹è¡¥æ ¹": 4}], [{"å°åƒè±†": 4}]]},
        "æ··åˆæµ†æœæ´¾": {"èƒ½é‡": 4200, "åˆ¶ä½œæœºå™¨": "ç‡ƒæ°”ç¶", "é…æ–¹": [[{"å†°éœœéº¦ç²’": 3}, {"å·¨è•¨è°·ç²’": 3}], [{"è™«æœ": 4}], [{"ç‚™çƒ¤åˆºæœ": 1}, {"åˆºå£³æœçƒ¤ä¸²": 1.6667}, {"æ¼«èŠ±æœ": 6.153}]]},

        "æœè–¯æ¡": {"èƒ½é‡": 5400, "åˆ¶ä½œæœºå™¨": "æ²¹ç‚¸é”…", "é…æ–¹": [[{"ç¾½å¶æœè–¯": 1}], [{"åŠ¨ç‰©æ²¹è„‚": 1}]]},
        "ç‚¸è±†å°åƒ": {"èƒ½é‡": 5000, "åˆ¶ä½œæœºå™¨": "æ²¹ç‚¸é”…", "é…æ–¹": [[{"å°åƒè±†": 6}], [{"åŠ¨ç‰©æ²¹è„‚": 1}]]},
        "é±¼è‚‰å·": {"èƒ½é‡": 4200, "åˆ¶ä½œæœºå™¨": "æ²¹ç‚¸é”…", "é…æ–¹": [[{"å¸•åº“é±¼ç‰‡": 1}], [{"åŠ¨ç‰©æ²¹è„‚": 2.4}], [{"å†°éœœé¢åŒ…": 2}], [{"å·¨è•¨è°·ç²’": 2}]]},
        "èŸ¹è‚‰å¤©å¦‡ç½—": {"èƒ½é‡": 4200, "åˆ¶ä½œæœºå™¨": "æ²¹ç‚¸é”…", "é…æ–¹": [[{"ç”ŸèŸ¹è‚‰": 1}], [{"åŠ¨ç‰©æ²¹è„‚": 2.4}], [{"å†°éœœé¢åŒ…": 2}], [{"å·¨è•¨è°·ç²’": 2}]]},

        "å«©è‚‹æ’": {"èƒ½é‡": 16000, "åˆ¶ä½œæœºå™¨": "ç†ç‚‰", "é…æ–¹": [[{"ç¡¬è‚‰": 6}], [{"æœ¨æ": 100}, {"æ³¥ç‚­": 100}]]},
        "ç†é±¼": {"èƒ½é‡": 4200, "åˆ¶ä½œæœºå™¨": "ç†ç‚‰", "é…æ–¹": [[{"å¸•åº“é±¼ç‰‡": 6}, {"é¢šé±¼ç‰‡": 6}], [{"æœ¨æ": 100}, {"æ³¥ç‚­": 100}]]},
        "çˆ†ç±³èŠ±": {"èƒ½é‡": 2862.5, "åˆ¶ä½œæœºå™¨": "ç†ç‚‰", "äº§é‡":4 ,"é…æ–¹": [[{"æ±—ç”œç‰ç±³": 7}, {"åˆºå£³æœ": 7}, {"è´«ç˜ è™«æœ": 7}], [{"æœ¨æ": 100}, {"æ³¥ç‚­": 100}]]},
    };
    const æ¤ç‰© = {
        "ç±³è™±æœ¨": {"ç”Ÿé•¿å‘¨æœŸ": [3,12], "äººå·¥åŸ¹è‚²": {"æ–½è‚¥": {"æ³¥åœŸ":[10,0]}}, "ç±³è™±": {"æ•°é‡": 1, "èƒ½é‡": 600}},
        "æ¯›åˆºèŠ±": {"ç”Ÿé•¿å‘¨æœŸ": [6,24], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"æ°´":[20,0]}}, "æ¯›åˆºæµ†æœ": {"æ•°é‡": 1, "èƒ½é‡": 1600}},
        "å¤œå¹•è‡": {"ç”Ÿé•¿å‘¨æœŸ": [7.5,30], "äººå·¥åŸ¹è‚²": {"æ–½è‚¥": {"èŒæ³¥":[4,0]}}, "è˜‘è‡": {"æ•°é‡": 1, "èƒ½é‡": 2400}},
        "å†°éœœå°éº¦": {"ç”Ÿé•¿å‘¨æœŸ": [18,72], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"æ°´":[20,0]}, "æ–½è‚¥": {"æ³¥åœŸ":[5,0]}}, "å†°éœœéº¦ç²’": {"æ•°é‡": 18}},
        "å°åƒèŠ½": {"ç”Ÿé•¿å‘¨æœŸ": [21,84], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"ä¹™é†‡":[20,0]}, "æ–½è‚¥": {"æ³¥åœŸ":[5,0]}}, "å°åƒè±†": {"æ•°é‡": 12}},
        "æ°´è‰": {"ç”Ÿé•¿å‘¨æœŸ": [12,48], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"ç›æ°´":[5,0]}, "æ–½è‚¥": {"æ¼‚ç™½çŸ³":[0.5,0]}}, "æµ·ç”Ÿèœ": {"æ•°é‡": 12, "èƒ½é‡": 4800}},
        "ç«æ¤’è—¤": {"ç”Ÿé•¿å‘¨æœŸ": [8,32], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"æ±¡æŸ“æ°´":[35,0]}, "æ–½è‚¥": {"ç£·çŸ¿":[1,0]}}, "ç«æ¤’ç²’": {"æ•°é‡": 4}},
        "æ²¼æµ†ç¬¼": {"ç”Ÿé•¿å‘¨æœŸ": [6.6,26.4], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"æ±¡æŸ“æ°´":[40,0]}}, "æ²¼æµ†æœå†»": {"æ•°é‡": 1, "èƒ½é‡": 1840}},
        "è´«ç˜ è™«æœèŠ½": {"ç”Ÿé•¿å‘¨æœŸ": [4,16], "äººå·¥åŸ¹è‚²": {"æ–½è‚¥": {"ç¡«":[10,0]}}, "è´«ç˜ è™«æœ": {"æ•°é‡": 1, "èƒ½é‡": 800}},
        "è™«æœèŠ½": {"ç”Ÿé•¿å‘¨æœŸ": [8,32], "äººå·¥åŸ¹è‚²": {"æ–½è‚¥": {"ç¡«":[10,0]}}, "è™«æœ": {"æ•°é‡": 8, "èƒ½é‡": 2000}},
        "åœŸæ˜ŸåŠ¨ç‰©æ•è‰": {"ç”Ÿé•¿å‘¨æœŸ": [30,120], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"æ±¡æŸ“æ°´":[10,0]}}, "æ¤ç‰©è‚‰": {"æ•°é‡": 10, "èƒ½é‡": 12000}},
        "åˆºå£³æœçŒæœ¨": {"ç”Ÿé•¿å‘¨æœŸ": [3,12], "äººå·¥åŸ¹è‚²": {"æ–½è‚¥": {"ç£·çŸ¿":[5,0]}}, "åˆºå£³æœ": {"æ•°é‡": 1, "èƒ½é‡": 800}},
        "ç¾½å¶æœè–¯æ¤æ ª": {"ç”Ÿé•¿å‘¨æœŸ": [9,36], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"ä¹™é†‡":[15,0]}}, "ç¾½å¶æœè–¯": {"æ•°é‡": 1, "èƒ½é‡": 4000}},
        "æ±—ç”œç‰ç±³æ†": {"ç”Ÿé•¿å‘¨æœŸ": [3,12], "äººå·¥åŸ¹è‚²": {"æ–½è‚¥": {"æ³¥ç‚­":[10,0]}}, "æ±—ç”œç‰ç±³": {"æ•°é‡": 1, "èƒ½é‡": 800}},
        "å·¨è•¨": {"ç”Ÿé•¿å‘¨æœŸ": [9,36], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"æ°¯æ°”":[54,13.5]}}, "å·¨è•¨è°·ç²’": {"æ•°é‡": 36}},
        "ä¹”æœ¨æ ‘": {"ç”Ÿé•¿å‘¨æœŸ": [4.5,18], "äººå·¥åŸ¹è‚²": {"çŒæº‰": {"æ±¡æŸ“æ°´":[70,0]}, "æ–½è‚¥": {"æ³¥åœŸ":[10,0]}}, "æœ¨æ": {"æ•°é‡": 300}},
    };
    const åŠ¨ç‰© = {
        "ç»’çŠ¸å…”": {"å¯¿å‘½":200,"æ­»äº¡æ‰è½":{"è‚‰":14}},
        "çš‡çŠ¸å…”": {"å¯¿å‘½":200,"æ­»äº¡æ‰è½":{"è‚‰":14}},
        "é€¸èœ¥": {"å¯¿å‘½":50,"æ­»äº¡æ‰è½":{"è‚‰":0.5}},
        "æ²™æ³¥èŸ¹": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"ç”ŸèŸ¹è‚‰":4}},
        "ç‹é¹¿": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "ç”œç´ ç”²è™«": {"å¯¿å‘½":75,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "æ¯›é³å£è™": {"å¯¿å‘½":150,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "è™«æœæœè™«": {"å¯¿å‘½":150,"æ­»äº¡æ‰è½":{"è‚‰":3}},
        "æ»‘é³å£è™": {"å¯¿å‘½":150,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "å¥½åƒå“ˆå¥‡": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "çŸ³å£³å“ˆå¥‡": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "å…‰æ»‘å“ˆå¥‡": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "è‰è´¨å“ˆå¥‡": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "é”¹ç¯ç”°é¼ ": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":10}},
        "çé¦ç”°é¼ ": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":5}},
        "é‡Šæ°”æµ·ç‰›": {"å¯¿å‘½":75,"æ­»äº¡æ‰è½":{"è‚‰":10}},
        "æµ®æ²¹ç”Ÿç‰©": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "é•¿æ¯›æµ®æ²¹ç”Ÿç‰©": {"å¯¿å‘½":150,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "ç†”å²©æµ®æ²¹ç”Ÿç‰©": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "å¸•åº“é±¼": {"å¯¿å‘½":25,"æ­»äº¡æ‰è½":{"å¸•åº“é±¼ç‰‡":1}},
        "å¤§å˜´é±¼": {"å¯¿å‘½":25,"æ­»äº¡æ‰è½":{"å¸•åº“é±¼ç‰‡":1}},
        "çƒ­å¸¦å¸•åº“é±¼": {"å¯¿å‘½":25,"æ­»äº¡æ‰è½":{"å¸•åº“é±¼ç‰‡":1}},
        "é¢šé±¼": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"é¢šé±¼ç‰‡":12}},
        "å–·æµ®é£é±¼": {"å¯¿å‘½":75,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "è´µæ—é£é±¼": {"å¯¿å‘½":75,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "æ´å‡€é£é±¼": {"å¯¿å‘½":75,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "åšå£³é£é±¼": {"å¯¿å‘½":75,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "éœ¸ç‹é¹¦": {"å¯¿å‘½":200,"æ­»äº¡æ‰è½":{"ç¡¬è‚‰":5}},
        "æ “è§’æµ·è±¹": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"åŠ¨ç‰©æ²¹è„‚":50}},
        "æ ‘é¼ ": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "æ¯›ç»’æ ‘é¼ ": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":1}},
        "ç”µå¼§è›è“": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "çƒŸé›¾è›è“": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "æµ·ç»µè›è“": {"å¯¿å‘½":100,"æ­»äº¡æ‰è½":{"è‚‰":2}},
        "å°–å—å…½": {"å¯¿å‘½":200,"æ­»äº¡æ‰è½":{"ç¡¬è‚‰":12}},
    };

    function FoodCalculator(){
        const [personNumber, setPersonNumber] = React.useState(12);
        const [bigPersonNumber, setBigPersonNumber] = React.useState(0);
        const [wildPlant, setWildPlant] = React.useState(false);
        const [dupHarvest, setDupHarvest] = React.useState(true);
        const [fertilization, setFertilization] = React.useState(false);
        const [foodMachine, setFoodMachine] = React.useState("");
        const [food, setFood] = React.useState("");
        const [result, setResult] = React.useState([]);
        const [isDarkTheme, setIsDarkTheme] = React.useState(false);

        React.useEffect(() => {
            const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
            setIsDarkTheme(mediaQuery.matches);

            const handleChange = (e) => {
                setIsDarkTheme(e.matches);
            };

            mediaQuery.addEventListener('change', handleChange);
            return () => mediaQuery.removeEventListener('change', handleChange);
        }, []);

        React.useEffect(() => {
            document.documentElement.setAttribute('data-theme', isDarkTheme ? 'dark' : 'light');
        }, [isDarkTheme]);

        const toggleTheme = () => {
            setIsDarkTheme(!isDarkTheme);
        };

        const calculateRequirements = () => {
            if (food == "" || food == null) return;

            let calcResult = [];
            let foodInfo = é£Ÿç‰©[food];
            let totalCaloriesNeeded = (personNumber * 1000) + bigPersonNumber * 500;
            let portionsNeeded = totalCaloriesNeeded / (foodInfo["èƒ½é‡"]*(é£Ÿç‰©[food]["äº§é‡"]||1));

            const findMaterialSources = (materialName, materialAmount, path = []) => {
                let sources = [];
                if (path.includes(materialName)) return sources;
                let newPath = [...path, materialName];

                let materialPlants = Object.entries(æ¤ç‰©).filter(([plantName, plantInfo]) => {
                    return plantInfo[materialName] != null;
                });

                let materialAnimals = Object.entries(åŠ¨ç‰©).filter(([animalName, animalInfo]) => {
                    return animalInfo["æ­»äº¡æ‰è½"][materialName] != null;
                });

                if (materialPlants.length > 0 || materialAnimals.length > 0) {
                    materialPlants.forEach(([plantName, plantInfo]) => {
                        let cycle = wildPlant ? plantInfo["ç”Ÿé•¿å‘¨æœŸ"][1] : plantInfo["ç”Ÿé•¿å‘¨æœŸ"][0];
                        if (fertilization && plantName !== "ç±³è™±æœ¨") cycle /= 2;
                        if (!dupHarvest) cycle += (plantName === "ä¹”æœ¨æ ‘" ? 20 : 4);

                        let outputPerCycle = plantInfo[materialName]["æ•°é‡"] || 1;
                        let plantCount = parseFloat(materialAmount * cycle / outputPerCycle).toFixed(2);

                        // è®¡ç®—æ¤ç‰©æ¶ˆè€—çš„èµ„æº
                        let resourceConsumption = [];
                        if (plantInfo["äººå·¥åŸ¹è‚²"]) {
                            Object.entries(plantInfo["äººå·¥åŸ¹è‚²"]).forEach(([action, resources]) => {
                                Object.entries(resources).forEach(([resourceName, resourceAmount]) => {
                                    // è®¡ç®—æ¯å‘¨æœŸæ¶ˆè€—çš„èµ„æºé‡
                                    let consumptionPerCycle = resourceAmount[wildPlant?1:0] * plantCount;
                                    resourceConsumption.push({
                                        èµ„æº: resourceName,
                                        æ•°é‡: parseFloat(consumptionPerCycle).toFixed(2),
                                        å•ä½: "åƒå…‹/å‘¨æœŸ"
                                    });
                                });
                            });
                        }

                        sources.push({
                            åç§°: plantName + " â†’ " + materialName,
                            æ•°é‡: plantCount,
                            å•ä½: "æ ª",
                            æ¥æº: [...newPath, plantName],
                            èµ„æºæ¶ˆè€—: resourceConsumption.length > 0 ? resourceConsumption : null
                        });
                    });

                    materialAnimals.forEach(([animalName, animalInfo]) => {
                        let dropAmount = animalInfo["æ­»äº¡æ‰è½"][materialName];
                        let animalCount = parseFloat(materialAmount * animalInfo["å¯¿å‘½"] / dropAmount).toFixed(2);

                        sources.push({
                            åç§°: animalName + " â†’ " + materialName,
                            æ•°é‡: animalCount,
                            å•ä½: "åª",
                            æ¥æº: [...newPath, animalName]
                        });
                    });
                    return sources;
                }

                let intermediateFood = é£Ÿç‰©[materialName];
                if (intermediateFood && intermediateFood.é…æ–¹) {
                    let intermediatePortionsNeeded = materialAmount;
                    intermediateFood.é…æ–¹.forEach((intermediateGroup, groupIndex) => {
                        intermediateGroup.forEach(intermediateMaterialObj => {
                            Object.entries(intermediateMaterialObj).forEach(([intermediateMaterialName, intermediateMaterialAmount]) => {
                                let totalIntermediateMaterialNeeded = intermediateMaterialAmount * intermediatePortionsNeeded;
                                let intermediateSources = findMaterialSources(
                                    intermediateMaterialName,
                                    totalIntermediateMaterialNeeded,
                                    newPath
                                );
                                sources.push(...intermediateSources);
                            });
                        });
                    });
                } else {
                    sources.push({
                        åç§°: materialName,
                        æ•°é‡: parseFloat(materialAmount).toFixed(2),
                        å•ä½: "åƒå…‹/å‘¨æœŸ",
                        æ¥æº: newPath
                    });
                }
                return sources;
            };

            let recipes = foodInfo["é…æ–¹"] ? foodInfo["é…æ–¹"] : [[{[food]: 1}]];

            recipes.forEach((materialGroup, groupIndex) => {
                let groupName = foodInfo["é…æ–¹"] ? `ææ–™ç»„ ${groupIndex + 1}` : food;
                let groupResult = {name: groupName, ingredients: []};

                materialGroup.forEach(materialObj => {
                    let orGroup = [];
                    Object.entries(materialObj).forEach(([materialName, materialAmount]) => {
                        let totalMaterialNeeded = materialAmount * portionsNeeded;
                        let materialSources = findMaterialSources(materialName, totalMaterialNeeded);
                        orGroup.push(...materialSources);
                    });
                    if (orGroup.length > 0) {
                        groupResult.ingredients.push(...orGroup);
                    }
                });

                if (groupResult.ingredients.length > 0) {
                    calcResult.push(groupResult);
                }
            });

            setResult(calcResult);
        };

        React.useEffect(() => {
            if (personNumber < bigPersonNumber) {
                setBigPersonNumber(personNumber);
            }
        }, [personNumber]);

        React.useEffect(() => {
            calculateRequirements();
        }, [personNumber, bigPersonNumber, wildPlant, dupHarvest, fertilization, food]);

        return (
            <div className="calculator-container">
                <div className="header">
                    <button className="theme-toggle" onClick={toggleTheme} title="åˆ‡æ¢ä¸»é¢˜">
                        {isDarkTheme ? 'â˜€ï¸' : 'ğŸŒ™'}
                    </button>
                    <h1>ğŸ—ï¸ å¤åˆ¶äººé£Ÿç‰©éœ€æ±‚è®¡ç®—å™¨</h1>
                    <p>è®¡ç®—æ°§æ°”ä¸æ˜¯ç¬¬ä¸€éœ€è¦çš„é£Ÿç‰©éœ€æ±‚ï¼Œç²¾å‡†è§„åˆ’ä½ çš„æ®–æ°‘åœ°</p>
                </div>

                <div className="content">
                    <div className="section">
                        <div className="section-title">ğŸ‘¥ å¤åˆ¶äººé…ç½®</div>
                        <div className="input-group">
                            <label>å¤åˆ¶äººæ•°é‡:</label>
                            <input
                                type="number"
                                step="1"
                                min="1"
                                value={personNumber}
                                onChange={e => setPersonNumber(parseInt(e.target.value) || 12)}
                            />
                        </div>
                        <div className="input-group">
                            <label>æ— åº•æ´ä¹‹èƒƒ:</label>
                            <input
                                type="number"
                                step="1"
                                min="0"
                                max={personNumber}
                                value={bigPersonNumber}
                                onChange={e => setBigPersonNumber(parseInt(e.target.value) || 0)}
                            />
                        </div>
                    </div>

                    <div className="section">
                        <div className="section-title">âš™ï¸ å†œä¸šé…ç½®</div>
                        <div className="checkbox-group">
                            <div className="checkbox-item">
                                <input
                                    type="checkbox"
                                    id="æ¤ç‰©é‡ç”Ÿ"
                                    checked={wildPlant}
                                    onChange={e=>setWildPlant(e.target.checked)}
                                />
                                <label htmlFor="æ¤ç‰©é‡ç”Ÿ">æ¤ç‰©é‡ç”Ÿ</label>
                            </div>
                            <div className="checkbox-item">
                                <input
                                    type="checkbox"
                                    id="äººå·¥æ”¶è·"
                                    checked={dupHarvest}
                                    onChange={e=>setDupHarvest(e.target.checked)}
                                />
                                <label htmlFor="äººå·¥æ”¶è·">äººå·¥æ”¶è·</label>
                            </div>
                            <div className="checkbox-item">
                                <input
                                    type="checkbox"
                                    id="æ–½è‚¥"
                                    checked={fertilization}
                                    onChange={e=>setFertilization(e.target.checked)}
                                />
                                <label htmlFor="æ–½è‚¥">æ–½è‚¥åŠ é€Ÿ</label>
                            </div>
                        </div>
                    </div>

                    <div className="section">
                        <div className="section-title">ğŸ½ï¸ é£Ÿç‰©é€‰æ‹©</div>
                        <div className="input-group">
                            <label>åˆ¶ä½œæœºå™¨:</label>
                            <select onChange={e=>setFoodMachine(e.target.value)}>
                                <option value="">é€‰æ‹©åˆ¶ä½œæœºå™¨</option>
                                <option value="ç”Ÿé£Ÿ">ç”Ÿé£Ÿ</option>
                                <option value="é£Ÿç‰©å‹åˆ¶å™¨">é£Ÿç‰©å‹åˆ¶å™¨</option>
                                <option value="ç”µåŠ¨çƒ¤ç‚‰">ç”µåŠ¨çƒ¤ç‚‰</option>
                                <option value="ç‡ƒæ°”ç¶">ç‡ƒæ°”ç¶</option>
                                <option value="æ²¹ç‚¸é”…">æ²¹ç‚¸é”…</option>
                                <option value="ç†ç‚‰">ç†ç‚‰</option>
                            </select>
                        </div>
                        <div className="input-group">
                            <label>é€‰æ‹©é£Ÿç‰©:</label>
                            <select onChange={e=>setFood(e.target.value)}>
                                <option value="">é€‰æ‹©é£Ÿç‰©</option>
                                {foodMachine ?
                                    Object.keys(Object.fromEntries(
                                        Object.entries(é£Ÿç‰©).filter(([é£Ÿç‰©åç§°, é£Ÿç‰©ä¿¡æ¯]) => é£Ÿç‰©ä¿¡æ¯["åˆ¶ä½œæœºå™¨"] === foodMachine)
                                    )).map(foodName => <option key={foodName} value={foodName}>{foodName}</option>):null}
                            </select>
                        </div>
                    </div>

                    {result && result.length > 0 && (
                        <div className="results-section">
                            <div className="results-title">ğŸ“Š è®¡ç®—ç»“æœ</div>
                            {result.map((item, idx1) => (
                                <div key={"group_"+idx1} className="material-group">
                                    <div className="group-title">{item.name}</div>
                                    <div className="ingredients-grid">
                                        {item.ingredients.map((recipe, idx2) => (
                                            <div key={"recipe_"+idx1+"_"+idx2} className="ingredient-card">
                                                <div className="ingredient-name">{recipe["åç§°"]}</div>
                                                <div className="ingredient-details">
                                                    æ•°é‡: {recipe["æ•°é‡"]} {recipe["å•ä½"]}
                                                </div>
                                                {recipe.æ¥æº && (
                                                    <div className="ingredient-path">
                                                        æ¥æº: {recipe.æ¥æº.join(' â†’ ')}
                                                    </div>
                                                )}
                                                {recipe.èµ„æºæ¶ˆè€— && recipe.èµ„æºæ¶ˆè€—.length > 0 && (
                                                    <div className="resource-consumption" style={{marginTop: '8px', paddingTop: '8px', borderTop: '1px dashed var(--border-light)'}}>
                                                        <div style={{fontSize: '0.8em', color: 'var(--accent-secondary)', marginBottom: '4px'}}>
                                                            èµ„æºæ¶ˆè€—:
                                                        </div>
                                                        {recipe.èµ„æºæ¶ˆè€—.map((resource, idx) => (
                                                            <div key={idx} style={{fontSize: '0.75em', color: 'var(--text-muted)'}}>
                                                                â€¢ {resource.èµ„æº}: {resource.æ•°é‡} {resource.å•ä½}
                                                            </div>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {result && result.length === 0 && food && (
                        <div className="no-results">
                            ğŸ‰ æ— éœ€é¢å¤–åŸæ–™ï¼è¿™æ˜¯ä¸€ä¸ªåŸºç¡€é£Ÿç‰©ã€‚
                        </div>
                    )}
                </div>
            </div>
        )
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<FoodCalculator />);
</script>
</body>
</html>