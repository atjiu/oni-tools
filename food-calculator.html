<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¼ºæ°§å¤åˆ¶äººé£Ÿç‰©éœ€æ±‚è®¡ç®—å™¨</title>
    <!-- <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> -->
    <script src="./js/consts.js"></script>
    <script src="./js/react-development-18.3.1.js"></script>
    <script src="./js/react-dom-development-18.3.1.js"></script>
    <script src="./js/babel-min-7.28.4.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%); --bg-secondary: white; --bg-tertiary: #f8f9fa; --bg-card: white; --text-primary: #2c3e50; --text-secondary: #34495e; --text-muted: #7f8c8d; --text-light: #95a5a6; --border-color: #e1e8ed; --border-light: #ecf0f1; --accent-primary: #3498db; --accent-secondary: #e74c3c; --accent-success: #27ae60; --shadow: 0 10px 30px rgba(0, 0, 0, 0.3); --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.1); }
        [data-theme="dark"] { --bg-primary: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); --bg-secondary: #1a1a1a; --bg-tertiary: #2d2d2d; --bg-card: #2d2d2d; --text-primary: #ffffff; --text-secondary: #e0e0e0; --text-muted: #b0b0b0; --text-light: #888888; --border-color: #404040; --border-light: #505050; --accent-primary: #4a9fea; --accent-secondary: #ff6b6b; --accent-success: #2ecc71; --shadow: 0 10px 30px rgba(0, 0, 0, 0.6); --shadow-light: 0 5px 15px rgba(0, 0, 0, 0.3); }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg-primary); min-height: 100vh; padding: 20px; color: var(--text-primary); transition: all 0.3s ease; }
        .calculator-container { max-width: 1200px; margin: 0 auto; background: var(--bg-secondary); border-radius: 15px; box-shadow: var(--shadow); overflow: hidden; transition: all 0.3s ease; }
        .header { background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 30px; text-align: center; position: relative; }
        .back-button { position: absolute; top: 20px; left: 20px; background: rgba(255, 255, 255, 0.1); border: none; border-radius: 25px; padding: 10px 20px; color: white; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 1em; font-weight: 500; transition: all 0.3s ease; backdrop-filter: blur(10px); }
        .back-button:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.05); }
        @media (max-width: 768px) { .back-button { top: 10px; left: 10px; padding: 8px 15px; font-size: 0.9em; } .theme-toggle { top: 10px; right: 10px; } }
        .theme-toggle { position: absolute; top: 20px; right: 20px; background: rgba(255, 255, 255, 0.1); border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.2em; transition: all 0.3s ease; }
        .theme-toggle:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.1); }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 300; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        .content { padding: 30px; background: var(--bg-secondary); transition: all 0.3s ease; }
        .section { background: var(--bg-tertiary); border-radius: 10px; padding: 25px; margin-bottom: 25px; border-left: 4px solid var(--accent-primary); transition: all 0.3s ease; }
        .section-title { font-size: 1.4em; color: var(--text-primary); margin-bottom: 20px; font-weight: 600; display: flex; align-items: center; gap: 10px; transition: all 0.3s ease; }
        .section-title::before { content: "â–¶"; color: var(--accent-primary); font-size: 0.8em; }
        .input-group { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; flex-wrap: wrap; flex-direction: column; align-items: flex-start; }
        .input-group label { font-weight: 500; color: var(--text-secondary); min-width: 120px; transition: all 0.3s ease; }
        input[type="number"] { padding: 10px 15px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1em; transition: all 0.3s ease; width: 120px; background: var(--bg-card); color: var(--text-primary); }
        input[type="number"]:focus { outline: none; border-color: var(--accent-primary); box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1); }
        select { padding: 10px 15px; border: 2px solid var(--border-color); border-radius: 8px; font-size: 1em; background: var(--bg-card); color: var(--text-primary); cursor: pointer; transition: all 0.3s ease; min-width: 200px; }
        select:focus { outline: none; border-color: var(--accent-primary); box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1); }
        .checkbox-group { display: flex; gap: 25px; flex-wrap: wrap; }
        .checkbox-item { display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 15px; background: var(--bg-card); border-radius: 8px; border: 2px solid var(--border-color); transition: all 0.3s ease; flex-shrink: 0; min-width: fit-content; }
        .checkbox-item:hover { border-color: var(--accent-primary); transform: translateY(-2px); }
        .checkbox-item input[type="checkbox"] { width: 18px; height: 18px; cursor: pointer; }
        .checkbox-item label { cursor: pointer; }
        .results-section { background: var(--bg-card); border-radius: 10px; padding: 25px; margin-top: 20px; border: 2px solid var(--border-color); transition: all 0.3s ease; }
        .results-title { font-size: 1.3em; color: var(--accent-success); margin-bottom: 20px; font-weight: 600; transition: all 0.3s ease; }
        .material-group { background: var(--bg-tertiary); border-radius: 10px; padding: 20px; margin-bottom: 20px; border-left: 4px solid var(--accent-secondary); transition: all 0.3s ease; }
        .group-title { font-size: 1.2em; color: var(--text-primary); margin-bottom: 15px; font-weight: 600; transition: all 0.3s ease; }
        .ingredients-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .ingredient-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; padding: 15px; transition: all 0.3s ease; }
        .ingredient-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-light); border-color: var(--accent-primary); }
        .ingredient-name { font-weight: 600; color: var(--text-primary); margin-bottom: 8px; font-size: 1.1em; transition: all 0.3s ease; }
        .ingredient-details { color: var(--text-muted); margin-bottom: 8px; transition: all 0.3s ease; }
        .ingredient-path { font-size: 0.85em; color: var(--text-light); font-style: italic; border-top: 1px dashed var(--border-light); padding-top: 8px; transition: all 0.3s ease; }
        .no-results { text-align: center; color: var(--text-muted); font-style: italic; padding: 40px; background: var(--bg-tertiary); border-radius: 10px; transition: all 0.3s ease; }
        @media (max-width: 768px) { .content { padding: 20px; } .input-group { flex-direction: column; align-items: flex-start; } .checkbox-group { flex-direction: row; gap: 15px; justify-content: flex-start; } .checkbox-item { flex: 0 0 auto; margin-bottom: 0; } .ingredients-grid { grid-template-columns: 1fr; } input[type="number"], select { width: 100%; } .theme-toggle { top: 10px; right: 10px; } }
        .icon-item { display: flex; align-items: center; gap: 8px; padding: 4px 0; }
        .icon-img { width: 24px; height: 24px; object-fit: contain; border-radius: 3px; flex-shrink: 0; }
        .icon-text { flex: 1; }
        select option { padding: 8px 12px; }
        .ingredient-with-icon { display: flex; align-items: center; gap: 8px; margin-bottom: 8px; }
        .ingredient-icon { width: 32px; height: 32px; object-fit: contain; border-radius: 4px; flex-shrink: 0; }
        .ingredient-text { flex: 1; }
        .path-item { display: inline-flex; align-items: center; gap: 4px; margin: 0 2px; }
        .path-icon { width: 16px; height: 16px; object-fit: contain; border-radius: 2px; }
        .radio-group { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 10px; }
        .radio-item { display: flex; align-items: center; gap: 8px; padding: 8px 15px; background: var(--bg-card); border: 2px solid var(--border-color); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; font-weight: 500; }
        .radio-item:hover { border-color: var(--accent-primary); transform: translateY(-2px); }
        .radio-item:has(input:checked) { background: rgba(52, 152, 219, 0.1); border-color: var(--accent-primary); }
        .radio-item input[type="radio"] { display: none; }
        .checkbox-group .checkbox-item input[type="radio"] { width: 18px; height: 18px; cursor: pointer; }
        .radio-icon { width: 24px; height: 24px; object-fit: contain; border-radius: 3px; flex-shrink: 0; }
        @media (max-width: 768px) { .radio-group { gap: 10px; } .radio-item { padding: 8px 12px; font-size: 0.9em; } }
        .person-config-group { display: flex; gap: 30px; align-items: center; flex-wrap: wrap; }
        .person-input-item { display: flex; align-items: center; gap: 10px; }
        .person-input-item label { font-weight: 500; color: var(--text-secondary); min-width: auto; white-space: nowrap; }
        .person-input-item input { width: 100px; }
        @media (max-width: 768px) { .person-config-group { flex-direction: column; gap: 15px; align-items: flex-start; } .person-input-item { width: 100%; } .person-input-item input { width: 120px; } }
        .food-option-content { display: flex; flex-direction: column; align-items: flex-start; gap: 2px; }
        .food-name { font-weight: 600; color: var(--text-primary); }
        .food-properties-small { display: flex; flex-direction: column; gap: 1px; }
        .food-property { display: flex; align-items: center; gap: 4px; font-size: 0.75em; color: var(--text-muted); line-height: 1.2; }
        .property-label { font-weight: 500; }
        .property-value { color: var(--text-light); }
        .food-radio-item { padding: 10px 15px; min-height: 60px; align-items: flex-start; }
        .machine-radio-item { padding: 8px 15px; min-height: auto; align-items: center; }
        @media (max-width: 768px) { .food-radio-item { padding: 8px 12px; min-height: 55px; } .machine-radio-item { padding: 8px 12px; } .food-property { font-size: 0.7em; } }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
    function FoodCalculator(){
        const [personNumber, setPersonNumber] = React.useState(12);
        const [bigPersonNumber, setBigPersonNumber] = React.useState(0);

        const [wildPlant, setWildPlant] = React.useState(false);
        const [dupHarvest, setDupHarvest] = React.useState(true);
        const [fertilization, setFertilization] = React.useState(false);

        const [creatureMode, setCreatureMode] = React.useState("domesticated");

        const [foodMachine, setFoodMachine] = React.useState("");
        const [food, setFood] = React.useState("");
        const [result, setResult] = React.useState([]);
        const [isDarkTheme, setIsDarkTheme] = React.useState(false);

        React.useEffect(() => {
            const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
            setIsDarkTheme(mediaQuery.matches);

            const handleChange = (e) => {
                setIsDarkTheme(e.matches);
            };

            mediaQuery.addEventListener('change', handleChange);
            return () => mediaQuery.removeEventListener('change', handleChange);
        }, []);

        React.useEffect(() => {
            document.documentElement.setAttribute('data-theme', isDarkTheme ? 'dark' : 'light');
        }, [isDarkTheme]);

        const goToHome = () => {
            window.location.href = 'index.html';
        };

        const toggleTheme = () => {
            setIsDarkTheme(!isDarkTheme);
        };

        const calculateRequirements = () => {
            if (food == "" || food == null) {
                setResult([]);
                return;
            }

            let calcResult = [];
            let foodInfo = é£Ÿç‰©[food];
            let totalCaloriesNeeded = (personNumber * 1000) + bigPersonNumber * 500;
            let portionsNeeded = totalCaloriesNeeded / (foodInfo["èƒ½é‡"]*(é£Ÿç‰©[food]["äº§é‡"]||1));

            const findMaterialSources = (materialName, materialAmount, path = []) => {
                let sources = [];
                if (path.includes(materialName)) return sources;
                let newPath = [...path, materialName];

                let materialPlants = Object.entries(æ¤ç‰©).filter(([plantName, plantInfo]) => {
                    return plantInfo[materialName] != null;
                });

                let materialAnimals = Object.entries(åŠ¨ç‰©).filter(([animalName, animalInfo]) => {
                    return (animalInfo["æ­»äº¡æ‰è½"] && animalInfo["æ­»äº¡æ‰è½"][materialName] != null) || materialName == "è›‹";
                });

                if (materialPlants.length > 0 || materialAnimals.length > 0) {
                    materialPlants.forEach(([plantName, plantInfo]) => {
                        let cycle = wildPlant ? plantInfo["ç”Ÿé•¿å‘¨æœŸ"][1] : plantInfo["ç”Ÿé•¿å‘¨æœŸ"][0];
                        if (fertilization && plantName !== "ç±³è™±æœ¨") cycle /= 2;
                        if (!dupHarvest) cycle += (plantName === "ä¹”æœ¨æ ‘" ? 20 : 4);

                        let outputPerCycle = plantInfo[materialName]["æ•°é‡"] || 1;
                        let plantCount = parseFloat(materialAmount * cycle / outputPerCycle).toFixed(2);

                        let resourceConsumption = [];
                        if (plantInfo["äººå·¥åŸ¹è‚²"]) {
                            Object.entries(plantInfo["äººå·¥åŸ¹è‚²"]).forEach(([action, resources]) => {
                                Object.entries(resources).forEach(([resourceName, resourceAmount]) => {
                                    let consumptionPerCycle = resourceAmount[wildPlant?1:0] * plantCount;
                                    resourceConsumption.push({
                                        èµ„æº: resourceName,
                                        æ•°é‡: parseFloat(consumptionPerCycle).toFixed(2),
                                        å•ä½: "åƒå…‹/å‘¨æœŸ"
                                    });
                                });
                            });
                        }

                        sources.push({
                            åç§°: plantName + " â†’ " + materialName,
                            æ•°é‡: plantCount,
                            å•ä½: "æ ª",
                            æ¥æº: [...newPath, plantName],
                            èµ„æºæ¶ˆè€—: resourceConsumption.length > 0 ? resourceConsumption : null
                        });
                    });

                    materialAnimals.forEach(([animalName, animalInfo]) => {
                        // ç²¾å…»æƒ…å†µä¸‹ä¸‹è›‹æ•°é‡
                        let eggCount = Math.floor((animalInfo["å¯¿å‘½"]-5)/(animalInfo["å¯¿å‘½"]*0.6/10));
                        let animalCount;
                        let description = "";
                        if (materialName === "è›‹") {
                            let dropAmount = animalInfo["è›‹"] * (creatureMode == "wild" ? 1: (eggCount-1));
                            animalCount = parseFloat(materialAmount * animalInfo["å¯¿å‘½"] / dropAmount).toFixed(2);
                            description = `æ¯åªäº§${eggCount}ä¸ªè›‹`;
                        } else {
                            let dropAmount = animalInfo["æ­»äº¡æ‰è½"][materialName] * (creatureMode == "wild" ? 1: (eggCount+1));
                            animalCount = parseFloat(materialAmount * animalInfo["å¯¿å‘½"] / dropAmount).toFixed(2);
                        }
                        if (!isNaN(animalCount)) {
                            sources.push({
                                åç§°: animalName + " â†’ " + materialName,
                                æ•°é‡: animalCount,
                                å•ä½: "åª",
                                æ¥æº: [...newPath, animalName],
                                è¯´æ˜: description || undefined
                            });
                        }
                    });
                    return sources;
                }

                let intermediateFood = é£Ÿç‰©[materialName];
                if (intermediateFood && intermediateFood.é…æ–¹) {
                    let intermediatePortionsNeeded = materialAmount;
                    intermediateFood.é…æ–¹.forEach((intermediateGroup, groupIndex) => {
                        intermediateGroup.forEach(intermediateMaterialObj => {
                            Object.entries(intermediateMaterialObj).forEach(([intermediateMaterialName, intermediateMaterialAmount]) => {
                                let totalIntermediateMaterialNeeded = intermediateMaterialAmount * intermediatePortionsNeeded;
                                let intermediateSources = findMaterialSources(
                                    intermediateMaterialName,
                                    totalIntermediateMaterialNeeded,
                                    newPath
                                );
                                sources.push(...intermediateSources);
                            });
                        });
                    });
                } else {
                    sources.push({
                        åç§°: materialName,
                        æ•°é‡: parseFloat(materialAmount).toFixed(2),
                        å•ä½: "åƒå…‹/å‘¨æœŸ",
                        è·¯å¾„: newPath
                    });
                }
                return sources;
            };

            let recipes = foodInfo["é…æ–¹"] ? foodInfo["é…æ–¹"] : [[{[food]: 1}]];

            recipes.forEach((materialGroup, groupIndex) => {
                let groupName = foodInfo["é…æ–¹"] ? `ææ–™ ${groupIndex + 1}` : food;
                let groupResult = {name: groupName, ingredients: []};

                materialGroup.forEach(materialObj => {
                    let orGroup = [];
                    Object.entries(materialObj).forEach(([materialName, materialAmount]) => {
                        let totalMaterialNeeded = materialAmount * portionsNeeded;
                        let materialSources = findMaterialSources(materialName, totalMaterialNeeded);
                        orGroup.push(...materialSources);
                    });
                    if (orGroup.length > 0) {
                        groupResult.ingredients.push(...orGroup);
                    }
                });

                if (groupResult.ingredients.length > 0) {
                    calcResult.push(groupResult);
                }
            });

            calcResult.forEach(item => {
                if (item.ingredients) {
                    item.ingredients.sort((a, b) => {
                        const numA = parseFloat(a.æ•°é‡);
                        const numB = parseFloat(b.æ•°é‡);

                        if (isNaN(numA) && isNaN(numB)) return 0;
                        if (isNaN(numA)) return 1;
                        if (isNaN(numB)) return -1;

                        return numA - numB;
                    });
                }
            });
            setResult(calcResult);
        };

        React.useEffect(() => {
            if (personNumber < bigPersonNumber) {
                setBigPersonNumber(personNumber);
            }
        }, [personNumber]);

        React.useEffect(() => {
            calculateRequirements();
        }, [personNumber, bigPersonNumber, wildPlant, dupHarvest, fertilization, creatureMode, food]);

        return (
            <div className="calculator-container">
                <div className="header">
                    <button className="back-button" onClick={goToHome} title="è¿”å›é¦–é¡µ">ğŸ  è¿”å›é¦–é¡µ</button>
                    <button className="theme-toggle" onClick={toggleTheme} title="åˆ‡æ¢ä¸»é¢˜">
                        {isDarkTheme ? 'â˜€ï¸' : 'ğŸŒ™'}
                    </button>
                    <h1>ğŸ—ï¸ å¤åˆ¶äººé£Ÿç‰©éœ€æ±‚è®¡ç®—å™¨</h1>
                    <p>è®¡ç®—æ°§æ°”ä¸æ˜¯ç¬¬ä¸€éœ€è¦çš„é£Ÿç‰©éœ€æ±‚ï¼Œç²¾å‡†è§„åˆ’ä½ çš„æ®–æ°‘åœ°</p>
                </div>

                <div className="content">
                    <div className="section">
                        <div className="section-title">ğŸ‘¥ å¤åˆ¶äººé…ç½®</div>
                        <div className="person-config-group">
                            <div className="person-input-item">
                                <label>å¤åˆ¶äººæ•°é‡:</label>
                                <input
                                    type="number"
                                    step="1"
                                    min="1"
                                    value={personNumber}
                                    onChange={e => setPersonNumber(parseInt(e.target.value) || 12)}
                                />
                            </div>
                            <div className="person-input-item">
                                <label>æ— åº•æ´ä¹‹èƒƒ:</label>
                                <input
                                    type="number"
                                    step="1"
                                    min="0"
                                    max={personNumber}
                                    value={bigPersonNumber}
                                    onChange={e => setBigPersonNumber(parseInt(e.target.value) || 0)}
                                />
                            </div>
                        </div>
                    </div>

                    <div className="section">
                        <div className="section-title">ğŸŒ± å†œä¸šé…ç½®</div>
                        <div className="checkbox-group">
                            <div className="checkbox-item">
                                <input
                                    type="checkbox"
                                    id="æ¤ç‰©é‡ç”Ÿ"
                                    checked={wildPlant}
                                    onChange={e=>setWildPlant(e.target.checked)}
                                />
                                <label htmlFor="æ¤ç‰©é‡ç”Ÿ">æ¤ç‰©é‡ç”Ÿ</label>
                            </div>
                            <div className="checkbox-item">
                                <input
                                    type="checkbox"
                                    id="äººå·¥æ”¶è·"
                                    checked={dupHarvest}
                                    onChange={e=>setDupHarvest(e.target.checked)}
                                />
                                <label htmlFor="äººå·¥æ”¶è·">äººå·¥æ”¶è·</label>
                            </div>
                            <div className="checkbox-item">
                                <input
                                    type="checkbox"
                                    id="æ–½è‚¥"
                                    checked={fertilization}
                                    onChange={e=>setFertilization(e.target.checked)}
                                />
                                <label htmlFor="æ–½è‚¥">æ–½è‚¥åŠ é€Ÿ</label>
                            </div>
                        </div>
                    </div>

                    <div className="section">
                        <div className="section-title">ğŸ„ ç•œç‰§é…ç½®</div>
                        <div className="checkbox-group">
                            <div className="checkbox-item">
                                <input
                                    type="radio"
                                    id="åŠ¨ç‰©é‡ç”Ÿ"
                                    name="åŠ¨ç‰©å…»æ®–"
                                    value="wild"
                                    checked={creatureMode === "wild"}
                                    onChange={e => setCreatureMode(e.target.value)}
                                />
                                <label htmlFor="åŠ¨ç‰©é‡ç”Ÿ">åŠ¨ç‰©é‡ç”Ÿ</label>
                            </div>
                            <div className="checkbox-item">
                                <input
                                    type="radio"
                                    id="åŠ¨ç‰©ç²¾å…»"
                                    name="åŠ¨ç‰©å…»æ®–"
                                    value="domesticated"
                                    checked={creatureMode === "domesticated"}
                                    onChange={e => setCreatureMode(e.target.value)}
                                />
                                <label htmlFor="åŠ¨ç‰©ç²¾å…»">åŠ¨ç‰©ç²¾å…»</label>
                            </div>
                        </div>
                    </div>

                    <div className="section">
                        <div className="section-title">ğŸ½ï¸ é£Ÿç‰©é€‰æ‹©</div>
                        <div className="input-group">
                            <div>åˆ¶ä½œæœºå™¨:</div>
                            <div className="radio-group">
                                {[...new Set(Object.values(é£Ÿç‰©).map(é£Ÿç‰©ä¿¡æ¯ => é£Ÿç‰©ä¿¡æ¯["åˆ¶ä½œæœºå™¨"]))].map(æœºå™¨ => (
                                    <label key={æœºå™¨} className="radio-item machine-radio-item">
                                        <input
                                            type="radio"
                                            name="foodMachine"
                                            value={æœºå™¨}
                                            checked={foodMachine === æœºå™¨}
                                            onChange={(e) => { setFoodMachine(e.target.value); setFood(""); }}
                                        />
                                        {å›¾ç‰‡[æœºå™¨] && (
                                            <img src={å›¾ç‰‡[æœºå™¨]} alt={æœºå™¨} className="radio-icon" />
                                        )}
                                        <span>{æœºå™¨}</span>
                                    </label>
                                ))}
                            </div>
                        </div>

                        {foodMachine && (
                            <div className="input-group" style={{marginTop: '15px'}}>
                                <div>é€‰æ‹©é£Ÿç‰©:</div>
                                <div className="radio-group">
                                    {Object.entries(é£Ÿç‰©)
                                        .filter(([é£Ÿç‰©åç§°, é£Ÿç‰©ä¿¡æ¯]) => é£Ÿç‰©ä¿¡æ¯["åˆ¶ä½œæœºå™¨"] === foodMachine)
                                        .map(([é£Ÿç‰©åç§°, é£Ÿç‰©ä¿¡æ¯]) => (
                                            <label key={é£Ÿç‰©åç§°} className="radio-item food-radio-item">
                                                <input
                                                    type="radio"
                                                    name="food"
                                                    value={é£Ÿç‰©åç§°}
                                                    checked={food === é£Ÿç‰©åç§°}
                                                    onChange={(e) => setFood(e.target.value)}
                                                />
                                                {å›¾ç‰‡[é£Ÿç‰©åç§°] && (
                                                    <img src={å›¾ç‰‡[é£Ÿç‰©åç§°]} alt={é£Ÿç‰©åç§°} className="radio-icon" />
                                                )}
                                                <div className="food-option-content">
                                                    <div className="food-name">{é£Ÿç‰©åç§°}</div>
                                                    <div className="food-properties-small">
                                                        {é£Ÿç‰©ä¿¡æ¯["å“è´¨"] && (
                                                            <div className="food-property">
                                                                <span className="property-label">å“è´¨:</span>
                                                                <span className="property-value">{é£Ÿç‰©ä¿¡æ¯["å“è´¨"]}</span>
                                                            </div>
                                                        )}
                                                        {é£Ÿç‰©ä¿¡æ¯["è…çƒ‚å‘¨æœŸ"] && (
                                                            <div className="food-property">
                                                                <span className="property-label">è…çƒ‚:</span>
                                                                <span className="property-value">{é£Ÿç‰©ä¿¡æ¯["è…çƒ‚å‘¨æœŸ"]!="ä¸ä¼šè…çƒ‚"?é£Ÿç‰©ä¿¡æ¯["è…çƒ‚å‘¨æœŸ"]+"å‘¨æœŸ":é£Ÿç‰©ä¿¡æ¯["è…çƒ‚å‘¨æœŸ"]}</span>
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                            </label>
                                        ))}
                                </div>
                            </div>
                        )}
                    </div>

                    {result && result.length > 0 && (
                        <div className="results-section">
                            <div className="results-title">ğŸ“Š è®¡ç®—ç»“æœ</div>
                            {result.map((item, idx1) => (
                                <div key={"group_"+idx1} className="material-group">
                                    <div className="group-title">{item.name}</div>
                                    <div className="ingredients-grid">
                                        {item.ingredients.map((recipe, idx2) => {
                                            // è§£æåç§°è·å–è´´å›¾
                                            const getIconForName = (name) => {
                                                // å¦‚æœæ˜¯"æ¤ç‰©å â†’ ææ–™å"æ ¼å¼
                                                if (name.includes(" â†’ ")) {
                                                    const parts = name.split(" â†’ ");
                                                    const sourceName = parts[0];
                                                    const materialName = parts[1];

                                                    return å›¾ç‰‡[sourceName] || å›¾ç‰‡[materialName];
                                                }

                                                return å›¾ç‰‡[name];
                                            };

                                            const iconUrl = getIconForName(recipe["åç§°"]);

                                            return (
                                                <div key={"recipe_"+idx1+"_"+idx2} className="ingredient-card">
                                                    <div className="ingredient-with-icon">
                                                        {iconUrl && (
                                                            <img src={iconUrl} alt={recipe["åç§°"]} className="ingredient-icon" />
                                                        )}
                                                        <div className="ingredient-text">
                                                            <div className="ingredient-name">{recipe["åç§°"]}</div>
                                                            <div className="ingredient-details">
                                                                æ•°é‡: {recipe["æ•°é‡"]} {recipe["å•ä½"]}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {recipe.æ¥æº && (
                                                        <div className="ingredient-path">
                                                            æ¥æº: {recipe.æ¥æº.reverse().map((item, index) => {
                                                                const pathIcon = å›¾ç‰‡[item];
                                                                return (
                                                                    <span key={index} className="path-item">
                                                                        {pathIcon && (
                                                                            <img src={pathIcon} alt={item} className="path-icon" />
                                                                        )}
                                                                        {item}
                                                                        {index < recipe.æ¥æº.length - 1 && " â†’ "}
                                                                    </span>
                                                                );
                                                            })}
                                                        </div>
                                                    )}
                                                    {recipe.èµ„æºæ¶ˆè€— && recipe.èµ„æºæ¶ˆè€—.length > 0 && (
                                                        <div className="resource-consumption" style={{marginTop: '8px', paddingTop: '8px', borderTop: '1px dashed var(--border-light)'}}>
                                                            <div style={{fontSize: '0.8em', color: 'var(--accent-secondary)', marginBottom: '4px'}}>
                                                                èµ„æºæ¶ˆè€—:
                                                            </div>
                                                            {recipe.èµ„æºæ¶ˆè€—.map((resource, idx) => (
                                                                <div key={idx} style={{fontSize: '0.75em', color: 'var(--text-muted)'}}>
                                                                    â€¢ {resource.èµ„æº}: {resource.æ•°é‡} {resource.å•ä½}
                                                                </div>
                                                            ))}
                                                        </div>
                                                    )}
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}

                    {result && result.length === 0 && food && (
                        <div className="no-results">
                            ğŸ‰ æ— éœ€é¢å¤–åŸæ–™ï¼è¿™æ˜¯ä¸€ä¸ªåŸºç¡€é£Ÿç‰©ã€‚
                        </div>
                    )}
                </div>
            </div>
        )
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<FoodCalculator />);
</script>
</body>
</html>